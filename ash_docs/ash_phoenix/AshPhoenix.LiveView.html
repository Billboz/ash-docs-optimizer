<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.34.2">
    <meta name="project" content="ash_phoenix v2.1.2">


    <title>AshPhoenix.LiveView â€” ash_phoenix v2.1.2</title>
    <link rel="stylesheet" href="dist/html-elixir-F2VRIOKR.css" />


    <script src="dist/handlebars.runtime-NWIB6V2M.js"></script>
    <script src="dist/handlebars.templates-K7URE6B4.js"></script>
    <script src="dist/sidebar_items-D13E551C.js"></script>
    <script src="docs_config.js"></script>
    <script async src="dist/html-YIPIRHGU.js"></script>
<script>
  if (location.hostname === "hexdocs.pm") {
    var script = document.createElement("script");
    script.src = "https://plausible.io/js/script.js";
    script.setAttribute("defer", "defer")
    script.setAttribute("data-domain", "ashhexdocs")
    document.head.appendChild(script);
  }
</script>

  </head>
  <body data-type="modules" class="page-module">
    <script>

      try {
        var settings = JSON.parse(localStorage.getItem('ex_doc:settings') || '{}');

        if (settings.theme === 'dark' ||
           ((settings.theme === 'system' || settings.theme == null) &&
             window.matchMedia('(prefers-color-scheme: dark)').matches)
           ) {
          document.body.classList.add('dark')
        }
      } catch (error) { }
    </script>

<div class="body-wrapper">

<button id="sidebar-menu" class="sidebar-button sidebar-toggle" aria-label="toggle sidebar" aria-controls="sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<nav id="sidebar" class="sidebar">

  <div class="sidebar-header">
    <div class="sidebar-projectInfo">

        <a href="https://github.com/ash-project/ash_phoenix" class="sidebar-projectImage">
          <img src="assets/logo.png" alt="ash_phoenix" />
        </a>

      <div>
        <a href="https://github.com/ash-project/ash_phoenix" class="sidebar-projectName" translate="no">
ash_phoenix
        </a>
        <div class="sidebar-projectVersion" translate="no">
          v2.1.2
        </div>
      </div>
    </div>
    <ul id="sidebar-listNav" class="sidebar-listNav" role="tablist">
      <li>
        <button id="extras-list-tab-button" role="tab" data-type="extras" aria-controls="extras-tab-panel" aria-selected="true" tabindex="0">
Pages
        </button>
      </li>

        <li>
          <button id="modules-list-tab-button" role="tab" data-type="modules" aria-controls="modules-tab-panel" aria-selected="false" tabindex="-1">
            Modules
          </button>
        </li>


        <li>
          <button id="tasks-list-tab-button" role="tab" data-type="tasks" aria-controls="tasks-tab-panel" aria-selected="false" tabindex="-1">
            <span translate="no">Mix</span> Tasks
          </button>
        </li>

    </ul>
  </div>

  <div id="extras-tab-panel" class="sidebar-tabpanel" role="tabpanel" aria-labelledby="extras-list-tab-button">
    <ul id="extras-full-list" class="full-list"></ul>
  </div>

    <div id="modules-tab-panel" class="sidebar-tabpanel" role="tabpanel" aria-labelledby="modules-list-tab-button" hidden>
      <ul id="modules-full-list" class="full-list"></ul>
    </div>


    <div id="tasks-tab-panel" class="sidebar-tabpanel" role="tabpanel" aria-labelledby="tasks-list-tab-button" hidden>
      <ul id="tasks-full-list" class="full-list"></ul>
    </div>

</nav>

<main class="content">
  <output role="status" id="toast"></output>

  <div id="content" class="content-inner">
    <div class="top-search">
      <div class="search-settings">
        <form class="search-bar" action="search.html">
          <label class="search-label">
            <span class="sr-only">Search documentation of ash_phoenix</span>
            <input name="q" type="text" class="search-input" placeholder="Press / to search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
          </label>
          <button type="submit" class="search-button" aria-label="Submit Search">
            <i class="ri-search-2-line ri-lg" aria-hidden="true" title="Submit search"></i>
          </button>
          <button type="button" tabindex="-1" class="search-close-button" aria-hidden="true">
            <i class="ri-close-line ri-lg" title="Cancel search"></i>
          </button>
        </form>
        <div class="autocomplete">
        </div>
        <button class="icon-settings display-settings">
          <i class="ri-settings-3-line"></i>
          <span class="sr-only">Settings</span>
        </button>
      </div>
    </div>

<div id="top-content">
  <h1>

      <a href="https://github.com/ash-project/ash_phoenix/blob/v2.1.2/lib/ash_phoenix/live_view.ex#L1" title="View Source" class="icon-action" rel="help">
        <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        <span class="sr-only">View Source</span>
      </a>

    <span translate="no">AshPhoenix.LiveView</span> 
    <small class="app-vsn" translate="no">(ash_phoenix v2.1.2)</small>

  </h1>


    <section id="moduledoc">
<p>Utilities for keeping Ash query results up to date in a LiveView.</p>
    </section>

</div>

  <section id="summary" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#summary">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Summary</span>
    </h1>
<div class="summary-types summary">
  <h2>
    <a href="#types">Types</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:assign/0" data-no-tooltip translate="no">assign()</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:assigns/0" data-no-tooltip translate="no">assigns()</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:callback/0" data-no-tooltip translate="no">callback()</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:callback_result/0" data-no-tooltip translate="no">callback_result()</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:liveness_options/0" data-no-tooltip translate="no">liveness_options()</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:socket/0" data-no-tooltip translate="no">socket()</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:topic/0" data-no-tooltip translate="no">topic()</a>

      </div>

    </div>

</div>
<div class="summary-functions summary">
  <h2>
    <a href="#functions">Functions</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#can_link_to_page?/2" data-no-tooltip translate="no">can_link_to_page?(page, target)</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#change_page/3" data-no-tooltip translate="no">change_page(socket, assign, target)</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#handle_live/4" data-no-tooltip translate="no">handle_live(socket, notification, assigns, refetch_info \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Incorporates an <a href="https://hexdocs.pm/ash/3.4.1/Ash.Notifier.Notification.html"><code class="inline">Ash.Notifier.Notification</code></a> into the query results, based on the liveness configuration.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#keep_live/4" data-no-tooltip translate="no">keep_live(socket, assign, callback, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Runs the callback, and stores the information required to keep it live in the socket assigns.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#last_page/1" data-no-tooltip translate="no">last_page(arg1)</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#next_page?/1" data-no-tooltip translate="no">next_page?(page)</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#on_page?/2" data-no-tooltip translate="no">on_page?(page, num)</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#page_from_params/3" data-no-tooltip translate="no">page_from_params(params, default_limit, count? \\ false)</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#page_link_params/2" data-no-tooltip translate="no">page_link_params(offset, target)</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#page_number/1" data-no-tooltip translate="no">page_number(arg1)</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#page_params/1" data-no-tooltip translate="no">page_params(keyset)</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#prev_page?/1" data-no-tooltip translate="no">prev_page?(page)</a>

      </div>

    </div>

</div>

  </section>


  <section id="types" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#types">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Types</span>
    </h1>
    <div class="types-list">
<section class="detail" id="t:assign/0">

  <div class="detail-header">
    <a href="#t:assign/0" class="detail-link" data-no-tooltip title="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature" translate="no">assign()</h1>

      <a href="https://github.com/ash-project/ash_phoenix/blob/v2.1.2/lib/ash_phoenix/live_view.ex#L7" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@type</span> assign() :: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>()</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:assigns/0">

  <div class="detail-header">
    <a href="#t:assigns/0" class="detail-link" data-no-tooltip title="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature" translate="no">assigns()</h1>

      <a href="https://github.com/ash-project/ash_phoenix/blob/v2.1.2/lib/ash_phoenix/live_view.ex#L8" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@type</span> assigns() :: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">map</a>()</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:callback/0">

  <div class="detail-header">
    <a href="#t:callback/0" class="detail-link" data-no-tooltip title="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature" translate="no">callback()</h1>

      <a href="https://github.com/ash-project/ash_phoenix/blob/v2.1.2/lib/ash_phoenix/live_view.ex#L131" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@type</span> callback() ::
  (<a href="#t:socket/0">socket</a>() -&gt; <a href="#t:callback_result/0">callback_result</a>())
  | (<a href="#t:socket/0">socket</a>(), <a href="https://hexdocs.pm/elixir/Keyword.html#t:t/0">Keyword.t</a>() | nil -&gt; <a href="#t:callback_result/0">callback_result</a>())</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:callback_result/0">

  <div class="detail-header">
    <a href="#t:callback_result/0" class="detail-link" data-no-tooltip title="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature" translate="no">callback_result()</h1>

      <a href="https://github.com/ash-project/ash_phoenix/blob/v2.1.2/lib/ash_phoenix/live_view.ex#L130" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@type</span> callback_result() :: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">struct</a>() | [<a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">struct</a>()] | <a href="https://hexdocs.pm/ash/3.4.1/Ash.Page.html#t:page/0">Ash.Page.page</a>() | nil</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:liveness_options/0">

  <div class="detail-header">
    <a href="#t:liveness_options/0" class="detail-link" data-no-tooltip title="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature" translate="no">liveness_options()</h1>

      <a href="https://github.com/ash-project/ash_phoenix/blob/v2.1.2/lib/ash_phoenix/live_view.ex#L10" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@type</span> liveness_options() :: <a href="https://hexdocs.pm/elixir/Keyword.html#t:t/0">Keyword.t</a>()</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:socket/0">

  <div class="detail-header">
    <a href="#t:socket/0" class="detail-link" data-no-tooltip title="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature" translate="no">socket()</h1>

      <a href="https://github.com/ash-project/ash_phoenix/blob/v2.1.2/lib/ash_phoenix/live_view.ex#L6" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@type</span> socket() :: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>()</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:topic/0">

  <div class="detail-header">
    <a href="#t:topic/0" class="detail-link" data-no-tooltip title="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature" translate="no">topic()</h1>

      <a href="https://github.com/ash-project/ash_phoenix/blob/v2.1.2/lib/ash_phoenix/live_view.ex#L9" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@type</span> topic() :: <a href="https://hexdocs.pm/elixir/String.html#t:t/0">String.t</a>()</pre>

      </div>


  </section>
</section>

    </div>
  </section>

  <section id="functions" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#functions">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Functions</span>
    </h1>
    <div class="functions-list">
<section class="detail" id="can_link_to_page?/2">

  <div class="detail-header">
    <a href="#can_link_to_page?/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">can_link_to_page?(page, target)</h1>

      <a href="https://github.com/ash-project/ash_phoenix/blob/v2.1.2/lib/ash_phoenix/live_view.ex#L352" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">


  </section>
</section>
<section class="detail" id="change_page/3">

  <div class="detail-header">
    <a href="#change_page/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">change_page(socket, assign, target)</h1>

      <a href="https://github.com/ash-project/ash_phoenix/blob/v2.1.2/lib/ash_phoenix/live_view.ex#L194" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">


  </section>
</section>
<section class="detail" id="handle_live/4">

    <span id="handle_live/3"></span>

  <div class="detail-header">
    <a href="#handle_live/4" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">handle_live(socket, notification, assigns, refetch_info \\ [])</h1>

      <a href="https://github.com/ash-project/ash_phoenix/blob/v2.1.2/lib/ash_phoenix/live_view.ex#L402" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Incorporates an <a href="https://hexdocs.pm/ash/3.4.1/Ash.Notifier.Notification.html"><code class="inline">Ash.Notifier.Notification</code></a> into the query results, based on the liveness configuration.</p><p>You will want to match on receiving a notification from Ash, and the easiest way to do that is to match
on the payload like so:</p><pre><code class="makeup elixir" translate="no"><span class="w">  </span><span class="na">@impl</span><span class="w"> </span><span class="no">true</span><span class="w">
</span><span class="kd">def</span><span class="w"> </span><span class="nf">handle_info</span><span class="p" data-group-id="5282798224-1">(</span><span class="p" data-group-id="5282798224-2">%{</span><span class="ss">topic</span><span class="p">:</span><span class="w"> </span><span class="n">topic</span><span class="p">,</span><span class="w"> </span><span class="ss">payload</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="5282798224-3">%</span><span class="nc" data-group-id="5282798224-3">Ash.Notifier.Notification</span><span class="p" data-group-id="5282798224-3">{</span><span class="p" data-group-id="5282798224-3">}</span><span class="p" data-group-id="5282798224-2">}</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="5282798224-1">)</span><span class="w"> </span><span class="k" data-group-id="5282798224-4">do</span><span class="w">
  </span><span class="p" data-group-id="5282798224-5">{</span><span class="ss">:noreply</span><span class="p">,</span><span class="w"> </span><span class="n">handle_live</span><span class="p" data-group-id="5282798224-6">(</span><span class="n">socket</span><span class="p">,</span><span class="w"> </span><span class="n">topic</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5282798224-7">[</span><span class="ss">:query1</span><span class="p">,</span><span class="w"> </span><span class="ss">:query2</span><span class="p">,</span><span class="w"> </span><span class="ss">:query3</span><span class="p" data-group-id="5282798224-7">]</span><span class="p" data-group-id="5282798224-6">)</span><span class="p" data-group-id="5282798224-5">}</span><span class="w">
</span><span class="k" data-group-id="5282798224-4">end</span></code></pre><p>Feel free to intercept notifications and do your own logic to respond to events. Ultimately, all
that matters is that you also call <a href="#handle_live/3"><code class="inline">handle_live/3</code></a> if you want it to update your query results.</p><p>The assign or list of assigns passed as the third argument must be the same names passed into
<code class="inline">keep_live</code>. If you only want some queries to update based on some events, you can define multiple
matches on events, and only call <a href="#handle_live/3"><code class="inline">handle_live/3</code></a> with the assigns that should be updated for that
notification.</p>
  </section>
</section>
<section class="detail" id="keep_live/4">

    <span id="keep_live/3"></span>

  <div class="detail-header">
    <a href="#keep_live/4" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">keep_live(socket, assign, callback, opts \\ [])</h1>

      <a href="https://github.com/ash-project/ash_phoenix/blob/v2.1.2/lib/ash_phoenix/live_view.ex#L134" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> keep_live(<a href="#t:socket/0">socket</a>(), <a href="#t:assign/0">assign</a>(), <a href="#t:callback/0">callback</a>(), <a href="#t:liveness_options/0">liveness_options</a>()) :: <a href="#t:socket/0">socket</a>()</pre>

      </div>

<p>Runs the callback, and stores the information required to keep it live in the socket assigns.</p><p>The data will be assigned to the provided key, e.g <code class="inline">keep_live(socket, :me, ...)</code> would assign the results
to <code class="inline">:me</code> (accessed as <code class="inline">@me</code> in the template).</p><p>Additionally, you'll need to define a <code class="inline">handle_info/2</code> callback for your liveview to receive any
notifications, and pass that notification into <a href="#handle_live/3"><code class="inline">handle_live/3</code></a>. See <a href="#handle_live/3"><code class="inline">handle_live/3</code></a> for more.</p><h2 id="keep_live/4-important" class="section-heading">
  <a href="#keep_live/4-important" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Important</span>
</h2>
<p>The logic for handling events to keep data live is currently very limited. It will simply rerun the query
every time. To this end, you should feel free to intercept individual events and handle them yourself for
more optimized liveness.</p><h2 id="keep_live/4-pagination" class="section-heading">
  <a href="#keep_live/4-pagination" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Pagination</span>
</h2>
<p>To make paginated views convenient, as well as making it possible to keep those views live, Ash does not
simply rerun the query when it gets an update, as that could involve shuffling the records around on the
page. Eventually this will be configurable, but for now, Ash simply adjusts the query to only include the
records that are on the page. If a record would be removed from a page due to a data change, it will simply
be left there. For the best performance, use <code class="inline">keyset</code> pagination. If you <em>need</em> the ability to jump to a
page by number, you'll want to use <code class="inline">offset</code> pagination, but keep in mind that it performs worse on large
tables.</p><p>To support this, accept a second parameter to your callback function, which will be the options to use in <code class="inline">page_opts</code></p><h2 id="keep_live/4-options" class="section-heading">
  <a href="#keep_live/4-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options:</span>
</h2>
<ul><li><p><code class="inline">:subscribe</code> - A topic or list of topics that should cause this data to update.</p></li><li><p><code class="inline">:refetch?</code> (<a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types"><code class="inline">boolean/0</code></a>) - A boolean flag indicating whether a refetch is allowed to happen. Defaults to <code class="inline">true</code></p></li><li><p><code class="inline">:after_fetch</code> (<a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types"><code class="inline">term/0</code></a>) - A two argument function that takes the results, and the socket, and returns the new socket. Can be used to set assigns based on the result of the query.</p></li><li><p><code class="inline">:results</code> - For list and page queries, by default the records shown are never changed (unless the page changes) Valid values are :keep, :lose The default value is <code class="inline">:keep</code>.</p></li><li><p><code class="inline">:load_until_connected?</code> (<a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types"><code class="inline">boolean/0</code></a>) - If the socket is not connected, then the value of the provided assign is set to <code class="inline">:loading</code>. Has no effect if <code class="inline">initial</code> is provided.</p></li><li><p><code class="inline">:initial</code> (<a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types"><code class="inline">term/0</code></a>) - Results to use instead of running the query immediately.</p></li><li><p><code class="inline">:refetch_interval</code> (<a href="https://hexdocs.pm/elixir/typespecs.html#basic-types"><code class="inline">non_neg_integer/0</code></a>) - An interval (in ms) to periodically refetch the query</p></li><li><p><code class="inline">:refetch_window</code> (<a href="https://hexdocs.pm/elixir/typespecs.html#basic-types"><code class="inline">non_neg_integer/0</code></a>) - The minimum time (in ms) between refetches, including refetches caused by notifications.</p></li></ul><p>A great way to get readable millisecond values is to use the functions in erlang's <code class="inline">:timer</code> module,
like <a href="https://www.erlang.org/doc/apps/stdlib/timer.html#hours/1"><code class="inline">:timer.hours/1</code></a>, <a href="https://www.erlang.org/doc/apps/stdlib/timer.html#minutes/1"><code class="inline">:timer.minutes/1</code></a>, and <a href="https://www.erlang.org/doc/apps/stdlib/timer.html#seconds/1"><code class="inline">:timer.seconds/1</code></a></p><h4>refetch_interval</h4><p>If this option is set, a message is sent as <code class="inline">{:refetch, assign_name, opts}</code> on that interval.
You can then match on that event, like so:</p><pre><code class="makeup elixir" translate="no"><span class="kd">def</span><span class="w"> </span><span class="nf">handle_info</span><span class="p" data-group-id="6613335403-1">(</span><span class="p" data-group-id="6613335403-2">{</span><span class="ss">:refetch</span><span class="p">,</span><span class="w"> </span><span class="n">assign</span><span class="p">,</span><span class="w"> </span><span class="n">opts</span><span class="p" data-group-id="6613335403-2">}</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="6613335403-1">)</span><span class="w"> </span><span class="k" data-group-id="6613335403-3">do</span><span class="w">
  </span><span class="p" data-group-id="6613335403-4">{</span><span class="ss">:noreply</span><span class="p">,</span><span class="w"> </span><span class="n">handle_live</span><span class="p" data-group-id="6613335403-5">(</span><span class="n">socket</span><span class="p">,</span><span class="w"> </span><span class="ss">:refetch</span><span class="p">,</span><span class="w"> </span><span class="n">assign</span><span class="p">,</span><span class="w"> </span><span class="n">opts</span><span class="p" data-group-id="6613335403-5">)</span><span class="p" data-group-id="6613335403-4">}</span><span class="w">
</span><span class="k" data-group-id="6613335403-3">end</span></code></pre><p>This is the equivalent of <code class="inline">:timer.send_interval(interval, {:refetch, assign, opts})</code>, so feel free to
roll your own solution if you have complex refetching requirements.</p><h4>refetch_window</h4><p>Normally, when a pubsub message is received the query is rerun. This option will cause the query to wait at least
this amount of time before doing a refetch. This is accomplished with <a href="https://hexdocs.pm/elixir/Process.html#send_after/4"><code class="inline">Process.send_after/4</code></a>, and recording the
last time each query was refetched. For example if a refetch happens at time <code class="inline">0</code>, and the <code class="inline">refetch_window</code> is
10,000 ms, we would refetch, and record the time. Then if another refetch should happen 5,000 ms later, we would
look and see that we need to wait another 5,000ms. So we use <a href="https://hexdocs.pm/elixir/Process.html#send_after/4"><code class="inline">Process.send_after/4</code></a> to send a
<code class="inline">{:refetch, assign, opts}</code> message in 5,000ms. The time that a refetch was requested is tracked, so if the
data has since been refetched, it won't be refetched again.</p><h4>Future Plans</h4><p>One interesting thing here is that, given that we know the scope of data that a resource cares about,
we should be able to make optimizations to this code, to support partial refetches, or even just updating
the data directly. However, this will need to be carefully considered, as the risks involve showing users
data they could be unauthorized to see, or having state in the socket that is inconsistent.</p>
  </section>
</section>
<section class="detail" id="last_page/1">

  <div class="detail-header">
    <a href="#last_page/1" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">last_page(arg1)</h1>

      <a href="https://github.com/ash-project/ash_phoenix/blob/v2.1.2/lib/ash_phoenix/live_view.ex#L356" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">


  </section>
</section>
<section class="detail" id="next_page?/1">

  <div class="detail-header">
    <a href="#next_page?/1" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">next_page?(page)</h1>

      <a href="https://github.com/ash-project/ash_phoenix/blob/v2.1.2/lib/ash_phoenix/live_view.ex#L281" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">


  </section>
</section>
<section class="detail" id="on_page?/2">

  <div class="detail-header">
    <a href="#on_page?/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">on_page?(page, num)</h1>

      <a href="https://github.com/ash-project/ash_phoenix/blob/v2.1.2/lib/ash_phoenix/live_view.ex#L366" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">


  </section>
</section>
<section class="detail" id="page_from_params/3">

    <span id="page_from_params/2"></span>

  <div class="detail-header">
    <a href="#page_from_params/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">page_from_params(params, default_limit, count? \\ false)</h1>

      <a href="https://github.com/ash-project/ash_phoenix/blob/v2.1.2/lib/ash_phoenix/live_view.ex#L228" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">


  </section>
</section>
<section class="detail" id="page_link_params/2">

  <div class="detail-header">
    <a href="#page_link_params/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">page_link_params(offset, target)</h1>

      <a href="https://github.com/ash-project/ash_phoenix/blob/v2.1.2/lib/ash_phoenix/live_view.ex#L285" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">


  </section>
</section>
<section class="detail" id="page_number/1">

  <div class="detail-header">
    <a href="#page_number/1" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">page_number(arg1)</h1>

      <a href="https://github.com/ash-project/ash_phoenix/blob/v2.1.2/lib/ash_phoenix/live_view.ex#L370" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">


  </section>
</section>
<section class="detail" id="page_params/1">

  <div class="detail-header">
    <a href="#page_params/1" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">page_params(keyset)</h1>

      <a href="https://github.com/ash-project/ash_phoenix/blob/v2.1.2/lib/ash_phoenix/live_view.ex#L248" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">


  </section>
</section>
<section class="detail" id="prev_page?/1">

  <div class="detail-header">
    <a href="#prev_page?/1" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">prev_page?(page)</h1>

      <a href="https://github.com/ash-project/ash_phoenix/blob/v2.1.2/lib/ash_phoenix/live_view.ex#L277" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">


  </section>
</section>

    </div>
  </section>

    <footer class="footer">
      <p>

          <span class="line">
            <a href="https://hex.pm/packages/ash_phoenix/2.1.2" class="footer-hex-package">Hex Package</a>

            <a href="https://preview.hex.pm/preview/ash_phoenix/2.1.2">Hex Preview</a>

          </span>

        <span class="line">
          <button class="a-main footer-button display-quick-switch" title="Search HexDocs packages">
            Search HexDocs
          </button>

            <a href="ash_phoenix.epub" title="ePub version">
              Download ePub version
            </a>

        </span>
      </p>

      <p class="built-using">
        Built using
        <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.34.2) for the

          <a href="https://elixir-lang.org" title="Elixir" target="_blank" translate="no">Elixir programming language</a>

      </p>

    </footer>
  </div>
</main>
</div>

  </body>
</html>
