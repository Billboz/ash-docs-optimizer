<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.34.2">
    <meta name="project" content="ash v3.4.8">


    <title>Ash.Changeset â€” ash v3.4.8</title>
    <link rel="stylesheet" href="dist/html-elixir-F2VRIOKR.css" />


    <script src="dist/handlebars.runtime-NWIB6V2M.js"></script>
    <script src="dist/handlebars.templates-K7URE6B4.js"></script>
    <script src="dist/sidebar_items-370365CE.js"></script>
    <script src="docs_config.js"></script>
    <script async src="dist/html-YIPIRHGU.js"></script>
<style>
  .livebook-badge-container + pre {
    display: none;
  }
</style>
<script>
  if (location.hostname === "hexdocs.pm") {
    var script = document.createElement("script");
    script.src = "https://plausible.io/js/script.js";
    script.setAttribute("defer", "defer")
    script.setAttribute("data-domain", "ashhexdocs")
    document.head.appendChild(script);
  }
</script>
<script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
<script>mermaid.initialize({startOnLoad: true})</script>

  </head>
  <body data-type="modules" class="page-module">
    <script>

      try {
        var settings = JSON.parse(localStorage.getItem('ex_doc:settings') || '{}');

        if (settings.theme === 'dark' ||
           ((settings.theme === 'system' || settings.theme == null) &&
             window.matchMedia('(prefers-color-scheme: dark)').matches)
           ) {
          document.body.classList.add('dark')
        }
      } catch (error) { }
    </script>

<div class="body-wrapper">

<button id="sidebar-menu" class="sidebar-button sidebar-toggle" aria-label="toggle sidebar" aria-controls="sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<nav id="sidebar" class="sidebar">

  <div class="sidebar-header">
    <div class="sidebar-projectInfo">

        <a href="https://github.com/ash-project/ash" class="sidebar-projectImage">
          <img src="assets/logo.png" alt="ash" />
        </a>

      <div>
        <a href="https://github.com/ash-project/ash" class="sidebar-projectName" translate="no">
ash
        </a>
        <div class="sidebar-projectVersion" translate="no">
          v3.4.8
        </div>
      </div>
    </div>
    <ul id="sidebar-listNav" class="sidebar-listNav" role="tablist">
      <li>
        <button id="extras-list-tab-button" role="tab" data-type="extras" aria-controls="extras-tab-panel" aria-selected="true" tabindex="0">
GUIDES
        </button>
      </li>

        <li>
          <button id="modules-list-tab-button" role="tab" data-type="modules" aria-controls="modules-tab-panel" aria-selected="false" tabindex="-1">
            Modules
          </button>
        </li>


        <li>
          <button id="tasks-list-tab-button" role="tab" data-type="tasks" aria-controls="tasks-tab-panel" aria-selected="false" tabindex="-1">
            <span translate="no">Mix</span> Tasks
          </button>
        </li>

    </ul>
  </div>

  <div id="extras-tab-panel" class="sidebar-tabpanel" role="tabpanel" aria-labelledby="extras-list-tab-button">
    <ul id="extras-full-list" class="full-list"></ul>
  </div>

    <div id="modules-tab-panel" class="sidebar-tabpanel" role="tabpanel" aria-labelledby="modules-list-tab-button" hidden>
      <ul id="modules-full-list" class="full-list"></ul>
    </div>


    <div id="tasks-tab-panel" class="sidebar-tabpanel" role="tabpanel" aria-labelledby="tasks-list-tab-button" hidden>
      <ul id="tasks-full-list" class="full-list"></ul>
    </div>

</nav>

<main class="content">
  <output role="status" id="toast"></output>

  <div id="content" class="content-inner">
    <div class="top-search">
      <div class="search-settings">
        <form class="search-bar" action="search.html">
          <label class="search-label">
            <span class="sr-only">Search documentation of ash</span>
            <input name="q" type="text" class="search-input" placeholder="Press / to search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
          </label>
          <button type="submit" class="search-button" aria-label="Submit Search">
            <i class="ri-search-2-line ri-lg" aria-hidden="true" title="Submit search"></i>
          </button>
          <button type="button" tabindex="-1" class="search-close-button" aria-hidden="true">
            <i class="ri-close-line ri-lg" title="Cancel search"></i>
          </button>
        </form>
        <div class="autocomplete">
        </div>
        <button class="icon-settings display-settings">
          <i class="ri-settings-3-line"></i>
          <span class="sr-only">Settings</span>
        </button>
      </div>
    </div>

<div id="top-content">
  <h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L1" title="View Source" class="icon-action" rel="help">
        <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        <span class="sr-only">View Source</span>
      </a>

    <span translate="no">Ash.Changeset</span> 
    <small class="app-vsn" translate="no">(ash v3.4.8)</small>

  </h1>


    <section id="moduledoc">
<p>Changesets are used to create and update data in Ash.</p><p>Create a changeset with <a href="#new/1"><code class="inline">new/1</code></a> or <code class="inline">new/2</code>, and alter the attributes
and relationships using the functions provided in this module.  Nothing in this module
actually incurs changes in a data layer. To commit a changeset, see <a href="Ash.html#create/2"><code class="inline">Ash.create/2</code></a>
and <a href="Ash.html#update/2"><code class="inline">Ash.update/2</code></a>.</p><h1>Changeset lifecycle</h1><h2 id="module-action-lifecycle" class="section-heading">
  <a href="#module-action-lifecycle" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Action Lifecycle</span>
</h2>
<p>The following example illustrates the hook lifecycle of a changeset.</p><pre><code class="makeup elixir" translate="no"><span class="kd">defmodule</span><span class="w"> </span><span class="nc">AshChangesetLifeCycleExample</span><span class="w"> </span><span class="k" data-group-id="6847490247-1">do</span><span class="w">
  </span><span class="kd">def</span><span class="w"> </span><span class="nf">change</span><span class="p" data-group-id="6847490247-2">(</span><span class="n">changeset</span><span class="p">,</span><span class="w"> </span><span class="bp">_</span><span class="p">,</span><span class="w"> </span><span class="bp">_</span><span class="p" data-group-id="6847490247-2">)</span><span class="w"> </span><span class="k" data-group-id="6847490247-3">do</span><span class="w">
    </span><span class="n">changeset</span><span class="w">
    </span><span class="c1"># execute code both before and after the transaction</span><span class="w">
    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Ash.Changeset</span><span class="o">.</span><span class="n">around_transaction</span><span class="p" data-group-id="6847490247-4">(</span><span class="k" data-group-id="6847490247-5">fn</span><span class="w"> </span><span class="n">changeset</span><span class="p">,</span><span class="w"> </span><span class="n">callback</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
      </span><span class="n">callback</span><span class="o">.</span><span class="p" data-group-id="6847490247-6">(</span><span class="n">changeset</span><span class="p" data-group-id="6847490247-6">)</span><span class="w">
    </span><span class="k" data-group-id="6847490247-5">end</span><span class="p" data-group-id="6847490247-4">)</span><span class="w">
    </span><span class="c1"># execute code before the transaction is started. Use for things like external calls</span><span class="w">
    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Ash.Changeset</span><span class="o">.</span><span class="n">before_transaction</span><span class="p" data-group-id="6847490247-7">(</span><span class="k" data-group-id="6847490247-8">fn</span><span class="w"> </span><span class="n">changeset</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">changeset</span><span class="w"> </span><span class="k" data-group-id="6847490247-8">end</span><span class="p" data-group-id="6847490247-7">)</span><span class="w">
    </span><span class="c1"># execute code in the transaction, before and after the data layer is called</span><span class="w">
    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Ash.Changeset</span><span class="o">.</span><span class="n">around_action</span><span class="p" data-group-id="6847490247-9">(</span><span class="k" data-group-id="6847490247-10">fn</span><span class="w"> </span><span class="n">changeset</span><span class="p">,</span><span class="w"> </span><span class="n">callback</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
      </span><span class="n">callback</span><span class="o">.</span><span class="p" data-group-id="6847490247-11">(</span><span class="n">changeset</span><span class="p" data-group-id="6847490247-11">)</span><span class="w">
    </span><span class="k" data-group-id="6847490247-10">end</span><span class="p" data-group-id="6847490247-9">)</span><span class="w">
    </span><span class="c1"># execute code in the transaction, before the data layer is called</span><span class="w">
    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Ash.Changeset</span><span class="o">.</span><span class="n">before_action</span><span class="p" data-group-id="6847490247-12">(</span><span class="k" data-group-id="6847490247-13">fn</span><span class="w"> </span><span class="n">changeset</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">changeset</span><span class="w"> </span><span class="k" data-group-id="6847490247-13">end</span><span class="p" data-group-id="6847490247-12">)</span><span class="w">
    </span><span class="c1"># execute code in the transaction, after the data layer is called, only if the action is successful</span><span class="w">
    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Ash.Changeset</span><span class="o">.</span><span class="n">after_action</span><span class="p" data-group-id="6847490247-14">(</span><span class="k" data-group-id="6847490247-15">fn</span><span class="w"> </span><span class="n">changeset</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p" data-group-id="6847490247-16">{</span><span class="ss">:ok</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p" data-group-id="6847490247-16">}</span><span class="w"> </span><span class="k" data-group-id="6847490247-15">end</span><span class="p" data-group-id="6847490247-14">)</span><span class="w">
    </span><span class="c1"># execute code after the transaction, both in success and error cases</span><span class="w">
    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Ash.Changeset</span><span class="o">.</span><span class="n">after_transaction</span><span class="p" data-group-id="6847490247-17">(</span><span class="k" data-group-id="6847490247-18">fn</span><span class="w"> </span><span class="n">changeset</span><span class="p">,</span><span class="w"> </span><span class="n">success_or_error_result</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">success_or_error_result</span><span class="w"> </span><span class="k" data-group-id="6847490247-18">end</span><span class="w">
  </span><span class="k">end</span><span class="w">
</span><span class="k">end</span></code></pre>
    </section>

</div>

  <section id="summary" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#summary">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Summary</span>
    </h1>
<div class="summary-types summary">
  <h2>
    <a href="#types">Types</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:after_action_fun/0" data-no-tooltip translate="no">after_action_fun()</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:after_transaction_fun/0" data-no-tooltip translate="no">after_transaction_fun()</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:around_action_callback/0" data-no-tooltip translate="no">around_action_callback()</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:around_action_fun/0" data-no-tooltip translate="no">around_action_fun()</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:around_action_result/0" data-no-tooltip translate="no">around_action_result()</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:around_transaction_callback/0" data-no-tooltip translate="no">around_transaction_callback()</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:around_transaction_fun/0" data-no-tooltip translate="no">around_transaction_fun()</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:around_transaction_result/0" data-no-tooltip translate="no">around_transaction_result()</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:before_action_fun/0" data-no-tooltip translate="no">before_action_fun()</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:before_transaction_fun/0" data-no-tooltip translate="no">before_transaction_fun()</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:error_info/0" data-no-tooltip translate="no">error_info()</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:manage_relationship_type/0" data-no-tooltip translate="no">manage_relationship_type()</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:phase/0" data-no-tooltip translate="no">phase()</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:t/0" data-no-tooltip translate="no">t()</a>

      </div>

    </div>

</div>
<div class="summary-functions summary">
  <h2>
    <a href="#functions">Functions</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#accessing/3" data-no-tooltip translate="no">accessing(changeset, types \\ [:attributes, :relationships, :calculations, :attributes], only_public? \\ true)</a>

      </div>

        <div class="summary-synopsis"><p>Returns a list of attributes, aggregates, relationships, and calculations that are being loaded</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#add_error/3" data-no-tooltip translate="no">add_error(changeset, errors, path \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds an error to the changesets errors list, and marks the change as <code class="inline">valid?: false</code>.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#after_action/3" data-no-tooltip translate="no">after_action(changeset, func, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds an after_action hook to the changeset.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#after_transaction/3" data-no-tooltip translate="no">after_transaction(changeset, func, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds an after_transaction hook to the changeset. Cannot be called within other hooks.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#apply_attributes/2" data-no-tooltip translate="no">apply_attributes(changeset, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Returns the original data with attribute changes merged, if the changeset is valid.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#around_action/2" data-no-tooltip translate="no">around_action(changeset, func)</a>

      </div>

        <div class="summary-synopsis"><p>Adds an around_action hook to the changeset.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#around_transaction/2" data-no-tooltip translate="no">around_transaction(changeset, func)</a>

      </div>

        <div class="summary-synopsis"><p>Adds an around_transaction hook to the changeset.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#atomic_ref/2" data-no-tooltip translate="no">atomic_ref(changeset, field)</a>

      </div>

        <div class="summary-synopsis"><p>Gets a reference to a field, or the current atomic update expression of that field.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#atomic_update/2" data-no-tooltip translate="no">atomic_update(changeset, atomics)</a>

      </div>

        <div class="summary-synopsis"><p>Adds multiple atomic changes to the changeset</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#atomic_update/3" data-no-tooltip translate="no">atomic_update(changeset, key, value)</a>

      </div>

        <div class="summary-synopsis"><p>Adds an atomic change to the changeset.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#attribute_present?/2" data-no-tooltip translate="no">attribute_present?(changeset, attribute)</a>

      </div>

        <div class="summary-synopsis"><p>Checks if an attribute is not nil, either in the original data, or that it is not being changed to a <code class="inline">nil</code> value if it is changing.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#before_action/3" data-no-tooltip translate="no">before_action(changeset, func, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a before_action hook to the changeset.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#before_transaction/3" data-no-tooltip translate="no">before_transaction(changeset, func, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a before_transaction hook to the changeset.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#change_attribute/3" data-no-tooltip translate="no">change_attribute(changeset, attribute, value)</a>

      </div>

        <div class="summary-synopsis"><p>Adds a change to the changeset, unless the value matches the existing value.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#change_attributes/2" data-no-tooltip translate="no">change_attributes(changeset, changes)</a>

      </div>

        <div class="summary-synopsis"><p>Calls <a href="#change_attribute/3"><code class="inline">change_attribute/3</code></a> for each key/value pair provided.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#change_default_attribute/3" data-no-tooltip translate="no">change_default_attribute(changeset, attribute, value)</a>

      </div>

        <div class="summary-synopsis"><p>The same as <code class="inline">change_attribute</code>, but annotates that the attribute is currently holding a default value.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#change_new_attribute/3" data-no-tooltip translate="no">change_new_attribute(changeset, attribute, value)</a>

      </div>

        <div class="summary-synopsis"><p>Change an attribute only if is not currently being changed</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#change_new_attribute_lazy/3" data-no-tooltip translate="no">change_new_attribute_lazy(changeset, attribute, func)</a>

      </div>

        <div class="summary-synopsis"><p>Change an attribute if is not currently being changed, by calling the provided function.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#changing_attribute?/2" data-no-tooltip translate="no">changing_attribute?(changeset, attribute)</a>

      </div>

        <div class="summary-synopsis"><p>Returns true if an attribute exists in the changes</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#changing_attributes?/1" data-no-tooltip translate="no">changing_attributes?(changeset)</a>

      </div>

        <div class="summary-synopsis"><p>Returns true if any attributes on the resource are being changed.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#changing_relationship?/2" data-no-tooltip translate="no">changing_relationship?(changeset, relationship)</a>

      </div>

        <div class="summary-synopsis"><p>Returns true if a relationship exists in the changes</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#clear_change/2" data-no-tooltip translate="no">clear_change(changeset, field)</a>

      </div>

        <div class="summary-synopsis"><p>Clears an attribute or relationship change off of the changeset.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#delete_argument/2" data-no-tooltip translate="no">delete_argument(changeset, argument_or_arguments)</a>

      </div>

        <div class="summary-synopsis"><p>Remove an argument from the changeset</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#deselect/2" data-no-tooltip translate="no">deselect(changeset, fields)</a>

      </div>

        <div class="summary-synopsis"><p>Ensure the the specified attributes are <code class="inline">nil</code> in the changeset results.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#ensure_selected/2" data-no-tooltip translate="no">ensure_selected(changeset, fields)</a>

      </div>

        <div class="summary-synopsis"><p>Ensures that the given attributes are selected.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#expand_upsert_fields/2" data-no-tooltip translate="no">expand_upsert_fields(fields, resource)</a>

      </div>

        <div class="summary-synopsis"><p>Turns the special case {:replace, fields}, :replace_all and {:replace_all_except, fields} upsert_fields
options into a list of fields</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#fetch_argument/2" data-no-tooltip translate="no">fetch_argument(changeset, argument)</a>

      </div>

        <div class="summary-synopsis"><p>Fetches the value of an argument provided to the changeset or <code class="inline">:error</code>.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#fetch_argument_or_change/2" data-no-tooltip translate="no">fetch_argument_or_change(changeset, attribute)</a>

      </div>

        <div class="summary-synopsis"><p>Gets the value of an argument provided to the changeset, falling back to <a href="#fetch_change/2"><code class="inline">Ash.Changeset.fetch_change/2</code></a> if nothing was provided.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#fetch_change/2" data-no-tooltip translate="no">fetch_change(changeset, attribute)</a>

      </div>

        <div class="summary-synopsis"><p>Gets the new value for an attribute, or <code class="inline">:error</code> if it is not being changed.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#filter/2" data-no-tooltip translate="no">filter(changeset, expr)</a>

      </div>

        <div class="summary-synopsis"><p>Adds a filter for a record being updated or destroyed.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#for_action/4" data-no-tooltip translate="no">for_action(initial, action, params \\ %{}, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Constructs a changeset for a given action, and validates it.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#for_create/4" data-no-tooltip translate="no">for_create(initial, action, params \\ %{}, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Constructs a changeset for a given create action, and validates it.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#for_destroy/4" data-no-tooltip translate="no">for_destroy(initial, action_or_name, params \\ %{}, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Constructs a changeset for a given destroy action, and validates it.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#for_update/4" data-no-tooltip translate="no">for_update(initial, action, params \\ %{}, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Constructs a changeset for a given update action, and validates it.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#force_change_attribute/3" data-no-tooltip translate="no">force_change_attribute(changeset, attribute, value)</a>

      </div>

        <div class="summary-synopsis"><p>Changes an attribute even if it isn't writable</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#force_change_attributes/2" data-no-tooltip translate="no">force_change_attributes(changeset, changes)</a>

      </div>

        <div class="summary-synopsis"><p>Calls <a href="#force_change_attribute/3"><code class="inline">force_change_attribute/3</code></a> for each key/value pair provided.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#force_change_new_attribute/3" data-no-tooltip translate="no">force_change_new_attribute(changeset, attribute, value)</a>

      </div>

        <div class="summary-synopsis"><p>Force change an attribute if it is not currently being changed.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#force_change_new_attribute_lazy/3" data-no-tooltip translate="no">force_change_new_attribute_lazy(changeset, attribute, func)</a>

      </div>

        <div class="summary-synopsis"><p>Force change an attribute if it is not currently being changed, by calling the provided function.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#force_set_argument/3" data-no-tooltip translate="no">force_set_argument(changeset, argument, value)</a>

      </div>

        <div class="summary-synopsis"><p>Add an argument to the changeset, which will be provided to the action.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#force_set_arguments/2" data-no-tooltip translate="no">force_set_arguments(changeset, map)</a>

      </div>

        <div class="summary-synopsis"><p>Merge a map of arguments to the arguments list.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#fully_atomic_changeset/4" data-no-tooltip translate="no">fully_atomic_changeset(resource, action, params, opts \\ [])</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#get_argument/2" data-no-tooltip translate="no">get_argument(changeset, argument)</a>

      </div>

        <div class="summary-synopsis"><p>Gets the value of an argument provided to the changeset.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#get_argument_or_attribute/2" data-no-tooltip translate="no">get_argument_or_attribute(changeset, attribute)</a>

      </div>

        <div class="summary-synopsis"><p>Gets the value of an argument provided to the changeset, falling back to <a href="#get_attribute/2"><code class="inline">Ash.Changeset.get_attribute/2</code></a> if nothing was provided.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#get_attribute/2" data-no-tooltip translate="no">get_attribute(changeset, attribute)</a>

      </div>

        <div class="summary-synopsis"><p>Gets the changing value or the original value of an attribute.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#get_data/2" data-no-tooltip translate="no">get_data(changeset, attribute)</a>

      </div>

        <div class="summary-synopsis"><p>Gets the original value for an attribute</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#handle_errors/2" data-no-tooltip translate="no">handle_errors(changeset, func)</a>

      </div>

        <div class="summary-synopsis"><p>Sets a custom error handler on the changeset.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#handle_params/4" data-no-tooltip translate="no">handle_params(changeset, action, params, handle_params_opts \\ [])</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#is_valid/1" data-no-tooltip translate="no">is_valid(changeset)</a>

      </div>

        <div class="summary-synopsis"><p>A guard which checks if the Changeset is valid.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#load/2" data-no-tooltip translate="no">load(changeset, load)</a>

      </div>

        <div class="summary-synopsis"><p>Calls the provided load statement on the result of the action at the very end of the action.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#loading?/2" data-no-tooltip translate="no">loading?(changeset, path)</a>

      </div>

        <div class="summary-synopsis"><p>Returns true if the field/relationship or path to field/relationship is being loaded.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#manage_relationship/4" data-no-tooltip translate="no">manage_relationship(changeset, relationship, input, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Manages the related records by creating, updating, or destroying them as necessary.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#manage_relationship_opts/1" data-no-tooltip translate="no">manage_relationship_opts(atom)</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#new/1" data-no-tooltip translate="no">new(record_or_resource)</a>

      </div>

        <div class="summary-synopsis"><p>Returns a new changeset over a resource.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#prepare_changeset_for_action/3" data-no-tooltip translate="no">prepare_changeset_for_action(changeset, action, opts)</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#present?/2" data-no-tooltip translate="no">present?(changeset, attribute)</a>

      </div>

        <div class="summary-synopsis"><p>Checks if an argument is not nil or an attribute is not nil, either in the original data, or that it is not being changed to a <code class="inline">nil</code> value if it is changing.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#put_context/3" data-no-tooltip translate="no">put_context(changeset, key, value)</a>

      </div>

        <div class="summary-synopsis"><p>Puts a key/value in the changeset context that can be used later.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#run_atomic_change/3" data-no-tooltip translate="no">run_atomic_change(changeset, map, context)</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#run_before_transaction_hooks/1" data-no-tooltip translate="no">run_before_transaction_hooks(changeset)</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#select/3" data-no-tooltip translate="no">select(changeset, fields, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Ensure that only the specified attributes are present in the results.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#selecting?/2" data-no-tooltip translate="no">selecting?(changeset, field)</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#set_argument/3" data-no-tooltip translate="no">set_argument(changeset, argument, value)</a>

      </div>

        <div class="summary-synopsis"><p>Add an argument to the changeset, which will be provided to the action.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#set_arguments/2" data-no-tooltip translate="no">set_arguments(changeset, map)</a>

      </div>

        <div class="summary-synopsis"><p>Merge a map of arguments to the arguments list.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#set_context/2" data-no-tooltip translate="no">set_context(changeset, map)</a>

      </div>

        <div class="summary-synopsis"><p>Deep merges the provided map into the changeset context that can be used later.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#set_on_upsert/2" data-no-tooltip translate="no">set_on_upsert(changeset, upsert_keys)</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#set_result/2" data-no-tooltip translate="no">set_result(changeset, result)</a>

      </div>

        <div class="summary-synopsis"><p>Set the result of the action. This will prevent running the underlying datalayer behavior</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#set_tenant/2" data-no-tooltip translate="no">set_tenant(changeset, tenant)</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#timeout/3" data-no-tooltip translate="no">timeout(changeset, timeout, default \\ nil)</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#update_change/3" data-no-tooltip translate="no">update_change(changeset, attribute, fun)</a>

      </div>

        <div class="summary-synopsis"><p>Updates an existing attribute change by applying a function to it.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#with_hooks/3" data-no-tooltip translate="no">with_hooks(changeset, func, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Wraps a function in the before/after action hooks of a changeset.</p></div>

    </div>

</div>

  </section>


  <section id="types" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#types">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Types</span>
    </h1>
    <div class="types-list">
<section class="detail" id="t:after_action_fun/0">

  <div class="detail-header">
    <a href="#t:after_action_fun/0" class="detail-link" data-no-tooltip title="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature" translate="no">after_action_fun()</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L214" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@type</span> after_action_fun() :: (<a href="#t:t/0">t</a>(), <a href="Ash.Resource.html#t:record/0">Ash.Resource.record</a>() -&gt;
                         {:ok, <a href="Ash.Resource.html#t:record/0">Ash.Resource.record</a>()}
                         | {:ok, <a href="Ash.Resource.html#t:record/0">Ash.Resource.record</a>(),
                            [<a href="Ash.Notifier.Notification.html#t:t/0">Ash.Notifier.Notification.t</a>()]}
                         | {:error, <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">any</a>()})</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:after_transaction_fun/0">

  <div class="detail-header">
    <a href="#t:after_transaction_fun/0" class="detail-link" data-no-tooltip title="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature" translate="no">after_transaction_fun()</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L220" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@type</span> after_transaction_fun() :: (<a href="#t:t/0">t</a>(),
                            {:ok, <a href="Ash.Resource.html#t:record/0">Ash.Resource.record</a>()}
                            | {:error, <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">any</a>()} -&gt;
                              {:ok, <a href="Ash.Resource.html#t:record/0">Ash.Resource.record</a>()} | {:error, <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">any</a>()})</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:around_action_callback/0">

  <div class="detail-header">
    <a href="#t:around_action_callback/0" class="detail-link" data-no-tooltip title="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature" translate="no">around_action_callback()</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L231" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@type</span> around_action_callback() :: (<a href="#t:t/0">t</a>() -&gt; <a href="#t:around_action_result/0">around_action_result</a>())</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:around_action_fun/0">

  <div class="detail-header">
    <a href="#t:around_action_fun/0" class="detail-link" data-no-tooltip title="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature" translate="no">around_action_fun()</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L232" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@type</span> around_action_fun() :: (<a href="#t:t/0">t</a>(), <a href="#t:around_action_callback/0">around_action_callback</a>() -&gt; <a href="#t:around_action_result/0">around_action_result</a>())</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:around_action_result/0">

  <div class="detail-header">
    <a href="#t:around_action_result/0" class="detail-link" data-no-tooltip title="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature" translate="no">around_action_result()</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L228" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@type</span> around_action_result() ::
  {:ok, <a href="Ash.Resource.html#t:record/0">Ash.Resource.record</a>(), <a href="#t:t/0">t</a>(),
   %{notifications: [<a href="Ash.Notifier.Notification.html#t:t/0">Ash.Notifier.Notification.t</a>()]}}
  | {:error, <a href="Ash.Error.html#t:t/0">Ash.Error.t</a>()}</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:around_transaction_callback/0">

  <div class="detail-header">
    <a href="#t:around_transaction_callback/0" class="detail-link" data-no-tooltip title="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature" translate="no">around_transaction_callback()</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L235" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@type</span> around_transaction_callback() :: (<a href="#t:t/0">t</a>() -&gt; <a href="#t:around_transaction_result/0">around_transaction_result</a>())</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:around_transaction_fun/0">

  <div class="detail-header">
    <a href="#t:around_transaction_fun/0" class="detail-link" data-no-tooltip title="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature" translate="no">around_transaction_fun()</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L236" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@type</span> around_transaction_fun() :: (<a href="#t:t/0">t</a>(), <a href="#t:around_transaction_callback/0">around_transaction_callback</a>() -&gt;
                               <a href="#t:around_transaction_result/0">around_transaction_result</a>())</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:around_transaction_result/0">

  <div class="detail-header">
    <a href="#t:around_transaction_result/0" class="detail-link" data-no-tooltip title="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature" translate="no">around_transaction_result()</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L234" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@type</span> around_transaction_result() :: {:ok, <a href="Ash.Resource.html#t:record/0">Ash.Resource.record</a>()} | {:error, <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">any</a>()}</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:before_action_fun/0">

  <div class="detail-header">
    <a href="#t:before_action_fun/0" class="detail-link" data-no-tooltip title="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature" translate="no">before_action_fun()</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L224" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@type</span> before_action_fun() :: (<a href="#t:t/0">t</a>() -&gt;
                          <a href="#t:t/0">t</a>()
                          | {<a href="#t:t/0">t</a>(),
                             %{notifications: [<a href="Ash.Notifier.Notification.html#t:t/0">Ash.Notifier.Notification.t</a>()]}})</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:before_transaction_fun/0">

  <div class="detail-header">
    <a href="#t:before_transaction_fun/0" class="detail-link" data-no-tooltip title="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature" translate="no">before_transaction_fun()</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L226" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@type</span> before_transaction_fun() :: (<a href="#t:t/0">t</a>() -&gt; <a href="#t:t/0">t</a>())</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:error_info/0">

  <div class="detail-header">
    <a href="#t:error_info/0" class="detail-link" data-no-tooltip title="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature" translate="no">error_info()</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L290" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@type</span> error_info() ::
  <a href="https://hexdocs.pm/elixir/String.html#t:t/0">String.t</a>()
  | [field: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>(), fields: [<a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>()], message: <a href="https://hexdocs.pm/elixir/String.html#t:t/0">String.t</a>(), value: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">any</a>()]
  | %{:__struct__ =&gt; <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>(), required(<a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>()) =&gt; <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">any</a>()}</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:manage_relationship_type/0">

  <div class="detail-header">
    <a href="#t:manage_relationship_type/0" class="detail-link" data-no-tooltip title="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature" translate="no">manage_relationship_type()</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L3912" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@type</span> manage_relationship_type() ::
  :append_and_remove | :append | :remove | :direct_control | :create</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:phase/0">

  <div class="detail-header">
    <a href="#t:phase/0" class="detail-link" data-no-tooltip title="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature" translate="no">phase()</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L250" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@type</span> phase() ::
  :around_transaction
  | :around_action
  | :after_transaction
  | :before_transaction
  | :after_action
  | :before_action
  | :validate
  | :pending
  | :atomic</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:t/0">

  <div class="detail-header">
    <a href="#t:t/0" class="detail-link" data-no-tooltip title="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature" translate="no">t()</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L252" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@type</span> t() :: %Ash.Changeset{
  __validated_for_action__: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>() | nil,
  action: <a href="Ash.Resource.Actions.html#t:action/0">Ash.Resource.Actions.action</a>() | nil,
  action_failed?: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">boolean</a>(),
  action_type: <a href="Ash.Resource.Actions.html#t:action_type/0">Ash.Resource.Actions.action_type</a>() | nil,
  added_filter: <a href="Ash.Filter.html#t:t/0">Ash.Filter.t</a>() | nil,
  after_action: [<a href="#t:after_action_fun/0">after_action_fun</a>() | {<a href="#t:after_action_fun/0">after_action_fun</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">map</a>()}],
  after_transaction: [
    <a href="#t:after_transaction_fun/0">after_transaction_fun</a>() | {<a href="#t:after_transaction_fun/0">after_transaction_fun</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">map</a>()}
  ],
  arguments: %{optional(<a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>()) =&gt; <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">any</a>()},
  around_action: [<a href="#t:around_action_fun/0">around_action_fun</a>() | {<a href="#t:around_action_fun/0">around_action_fun</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">map</a>()}],
  around_transaction: [
    <a href="#t:around_transaction_fun/0">around_transaction_fun</a>() | {<a href="#t:around_transaction_fun/0">around_transaction_fun</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">map</a>()}
  ],
  atomic_after_action: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>(),
  atomic_changes: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>(),
  atomic_validations: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>(),
  atomics: <a href="https://hexdocs.pm/elixir/Keyword.html#t:t/0">Keyword.t</a>(),
  attribute_changes: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>(),
  attributes: %{optional(<a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>()) =&gt; <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">any</a>()},
  before_action: [<a href="#t:before_action_fun/0">before_action_fun</a>() | {<a href="#t:around_action_fun/0">around_action_fun</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">map</a>()}],
  before_transaction: [
    <a href="#t:before_transaction_fun/0">before_transaction_fun</a>() | {<a href="#t:before_transaction_fun/0">before_transaction_fun</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">map</a>()}
  ],
  casted_arguments: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>(),
  casted_attributes: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>(),
  context: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">map</a>(),
  context_changes: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>(),
  data: <a href="Ash.Resource.html#t:record/0">Ash.Resource.record</a>() | nil,
  defaults: [<a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>()],
  dirty_hooks: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>(),
  domain: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">module</a>() | nil,
  errors: [<a href="Ash.Error.html#t:t/0">Ash.Error.t</a>()],
  filter: <a href="Ash.Filter.html#t:t/0">Ash.Filter.t</a>() | nil,
  handle_errors:
    nil
    | (<a href="#t:t/0">t</a>(), error :: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">any</a>() -&gt;
         :ignore | <a href="#t:t/0">t</a>() | (error :: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">any</a>()) | {error :: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">any</a>(), <a href="#t:t/0">t</a>()}),
  invalid_keys: <a href="https://hexdocs.pm/elixir/MapSet.html#t:t/0">MapSet.t</a>(),
  load: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">keyword</a>(<a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">keyword</a>()),
  params: %{optional(<a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>() | <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">binary</a>()) =&gt; <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">any</a>()},
  phase: <a href="#t:phase/0">phase</a>(),
  relationships: %{
    optional(<a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>()) =&gt;
      %{optional(<a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>() | <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">binary</a>()) =&gt; <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">any</a>()}
      | [%{optional(<a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>() | <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">binary</a>()) =&gt; <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">any</a>()}]
  },
  resource: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">module</a>(),
  select: [<a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>()] | nil,
  tenant: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>(),
  timeout: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">pos_integer</a>() | nil,
  to_tenant: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>(),
  valid?: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">boolean</a>()
}</pre>

      </div>


  </section>
</section>

    </div>
  </section>

  <section id="functions" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#functions">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Functions</span>
    </h1>
    <div class="functions-list">
<section class="detail" id="accessing/3">

    <span id="accessing/1"></span>

    <span id="accessing/2"></span>

  <div class="detail-header">
    <a href="#accessing/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">accessing(changeset, types \\ [:attributes, :relationships, :calculations, :attributes], only_public? \\ true)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L548" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Returns a list of attributes, aggregates, relationships, and calculations that are being loaded</p><p>Provide a list of field types to narrow down the returned results.</p>
  </section>
</section>
<section class="detail" id="add_error/3">

    <span id="add_error/2"></span>

  <div class="detail-header">
    <a href="#add_error/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">add_error(changeset, errors, path \\ [])</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L5567" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> add_error(<a href="#t:t/0">t</a>(), <a href="#t:error_info/0">error_info</a>() | [<a href="#t:error_info/0">error_info</a>()], <a href="https://hexdocs.pm/elixir/Keyword.html#t:t/0">Keyword.t</a>()) :: <a href="#t:t/0">t</a>()</pre>

      </div>

<p>Adds an error to the changesets errors list, and marks the change as <code class="inline">valid?: false</code>.</p><h2 id="add_error/3-error-data" class="section-heading">
  <a href="#add_error/3-error-data" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Error Data</span>
</h2>
<p>The given <code class="inline">errors</code> argument can be a string, a keyword list, a struct, or a list of any of the three.</p><p>If <code class="inline">errors</code> is a keyword list, or a list of keyword lists, the following keys are supported in the keyword list:</p><ul><li><code class="inline">field</code> (atom) - the field that the error is for. This is required, unless <code class="inline">fields</code> is given.</li><li><code class="inline">fields</code> (list of atoms) - the fields that the error is for. This is required, unless <code class="inline">field</code> is given.</li><li><code class="inline">message</code> (string) - the error message</li><li><code class="inline">value</code> (any) - (optional) the field value that caused the error</li></ul>
  </section>
</section>
<section class="detail" id="after_action/3">

    <span id="after_action/2"></span>

  <div class="detail-header">
    <a href="#after_action/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">after_action(changeset, func, opts \\ [])</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L5201" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> after_action(
  <a href="#t:t/0">t</a>(),
  <a href="#t:after_action_fun/0">after_action_fun</a>(),
  <a href="https://hexdocs.pm/elixir/Keyword.html#t:t/0">Keyword.t</a>()
) :: <a href="#t:t/0">t</a>()</pre>

      </div>

<p>Adds an after_action hook to the changeset.</p><p>Provide the option <code class="inline">prepend?: true</code> to place the hook before all
other hooks instead of after.</p>
  </section>
</section>
<section class="detail" id="after_transaction/3">

    <span id="after_transaction/2"></span>

  <div class="detail-header">
    <a href="#after_transaction/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">after_transaction(changeset, func, opts \\ [])</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L5241" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> after_transaction(
  <a href="#t:t/0">t</a>(),
  <a href="#t:after_transaction_fun/0">after_transaction_fun</a>(),
  <a href="https://hexdocs.pm/elixir/Keyword.html#t:t/0">Keyword.t</a>()
) :: <a href="#t:t/0">t</a>()</pre>

      </div>

<p>Adds an after_transaction hook to the changeset. Cannot be called within other hooks.</p><p><code class="inline">after_transaction</code> hooks differ from <code class="inline">after_action</code> hooks in that they are run
on success <em>and</em> failure of the action or some previous hook.</p><p>Provide the option <code class="inline">prepend?: true</code> to place the hook before all
other hooks instead of after.</p>
  </section>
</section>
<section class="detail" id="apply_attributes/2">

    <span id="apply_attributes/1"></span>

  <div class="detail-header">
    <a href="#apply_attributes/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">apply_attributes(changeset, opts \\ [])</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L5423" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> apply_attributes(<a href="#t:t/0">t</a>(), opts :: <a href="https://hexdocs.pm/elixir/Keyword.html#t:t/0">Keyword.t</a>()) ::
  {:ok, <a href="Ash.Resource.html#t:record/0">Ash.Resource.record</a>()} | {:error, <a href="#t:t/0">t</a>()}</pre>

      </div>

<p>Returns the original data with attribute changes merged, if the changeset is valid.</p><p>Options:</p><ul><li>force? - applies current attributes even if the changeset is not valid</li></ul>
  </section>
</section>
<section class="detail" id="around_action/2">

  <div class="detail-header">
    <a href="#around_action/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">around_action(changeset, func)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L5327" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> around_action(<a href="#t:t/0">t</a>(), <a href="#t:around_action_fun/0">around_action_fun</a>()) :: <a href="#t:t/0">t</a>()</pre>

      </div>

<p>Adds an around_action hook to the changeset.</p><p>Your function will get the changeset, and a callback that must be called with a changeset (that may be modified).
The callback will return <code class="inline">{:ok, result, instructions}</code> or <code class="inline">{:error, error}</code>. You can modify these values, but the
return value must be one of those types. Instructions contains the notifications in its <code class="inline">notifications</code> key, i.e
<code class="inline">%{notifications: [%Ash.Resource.Notification{}, ...]}</code>.</p><p>The around_action calls happen first, and then (after they each resolve their callbacks) the <code class="inline">before_action</code>
hooks are called, followed by the action itself occurring at the data layer and then the <code class="inline">after_action</code> hooks being run.
Then, the code that appeared <em>after</em> the callbacks were called is then run.</p><p>For example:</p><pre><code class="makeup elixir" translate="no"><span class="n">changeset</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Ash.Changeset</span><span class="o">.</span><span class="n">around_action</span><span class="p" data-group-id="1701400430-1">(</span><span class="k" data-group-id="1701400430-2">fn</span><span class="w"> </span><span class="n">changeset</span><span class="p">,</span><span class="w"> </span><span class="n">callback</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
  </span><span class="nc">IO</span><span class="o">.</span><span class="n">puts</span><span class="p" data-group-id="1701400430-3">(</span><span class="s">&quot;first around: before&quot;</span><span class="p" data-group-id="1701400430-3">)</span><span class="w">
  </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">callback</span><span class="o">.</span><span class="p" data-group-id="1701400430-4">(</span><span class="n">changeset</span><span class="p" data-group-id="1701400430-4">)</span><span class="w">
  </span><span class="nc">IO</span><span class="o">.</span><span class="n">puts</span><span class="p" data-group-id="1701400430-5">(</span><span class="s">&quot;first around: after&quot;</span><span class="p" data-group-id="1701400430-5">)</span><span class="w">

  </span><span class="n">result</span><span class="w">
</span><span class="k" data-group-id="1701400430-2">end</span><span class="p" data-group-id="1701400430-1">)</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Ash.Changeset</span><span class="o">.</span><span class="n">around_action</span><span class="p" data-group-id="1701400430-6">(</span><span class="k" data-group-id="1701400430-7">fn</span><span class="w"> </span><span class="n">changeset</span><span class="p">,</span><span class="w"> </span><span class="n">callback</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
  </span><span class="nc">IO</span><span class="o">.</span><span class="n">puts</span><span class="p" data-group-id="1701400430-8">(</span><span class="s">&quot;second around: before&quot;</span><span class="p" data-group-id="1701400430-8">)</span><span class="w">
  </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">callback</span><span class="o">.</span><span class="p" data-group-id="1701400430-9">(</span><span class="n">changeset</span><span class="p" data-group-id="1701400430-9">)</span><span class="w">
  </span><span class="nc">IO</span><span class="o">.</span><span class="n">puts</span><span class="p" data-group-id="1701400430-10">(</span><span class="s">&quot;second around: after&quot;</span><span class="p" data-group-id="1701400430-10">)</span><span class="w">

  </span><span class="n">result</span><span class="w">
</span><span class="k" data-group-id="1701400430-7">end</span><span class="p" data-group-id="1701400430-6">)</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Ash.Changeset</span><span class="o">.</span><span class="n">before_action</span><span class="p" data-group-id="1701400430-11">(</span><span class="k" data-group-id="1701400430-12">fn</span><span class="w"> </span><span class="n">changeset</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
  </span><span class="nc">IO</span><span class="o">.</span><span class="n">puts</span><span class="p" data-group-id="1701400430-13">(</span><span class="s">&quot;first before&quot;</span><span class="p" data-group-id="1701400430-13">)</span><span class="w">
  </span><span class="n">changeset</span><span class="w">
</span><span class="k" data-group-id="1701400430-12">end</span><span class="p">,</span><span class="w"> </span><span class="ss">append?</span><span class="p">:</span><span class="w"> </span><span class="no">true</span><span class="p" data-group-id="1701400430-11">)</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Ash.Changeset</span><span class="o">.</span><span class="n">before_action</span><span class="p" data-group-id="1701400430-14">(</span><span class="k" data-group-id="1701400430-15">fn</span><span class="w"> </span><span class="n">changeset</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
  </span><span class="nc">IO</span><span class="o">.</span><span class="n">puts</span><span class="p" data-group-id="1701400430-16">(</span><span class="s">&quot;second before&quot;</span><span class="p" data-group-id="1701400430-16">)</span><span class="w">
  </span><span class="n">changeset</span><span class="w">
</span><span class="k" data-group-id="1701400430-15">end</span><span class="p">,</span><span class="w"> </span><span class="ss">append?</span><span class="p">:</span><span class="w"> </span><span class="no">true</span><span class="p" data-group-id="1701400430-14">)</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Ash.Changeset</span><span class="o">.</span><span class="n">after_action</span><span class="p" data-group-id="1701400430-17">(</span><span class="k" data-group-id="1701400430-18">fn</span><span class="w"> </span><span class="n">changeset</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
  </span><span class="nc">IO</span><span class="o">.</span><span class="n">puts</span><span class="p" data-group-id="1701400430-19">(</span><span class="s">&quot;first after&quot;</span><span class="p" data-group-id="1701400430-19">)</span><span class="w">
  </span><span class="p" data-group-id="1701400430-20">{</span><span class="ss">:ok</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p" data-group-id="1701400430-20">}</span><span class="w">
</span><span class="k" data-group-id="1701400430-18">end</span><span class="p" data-group-id="1701400430-17">)</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Ash.Changeset</span><span class="o">.</span><span class="n">after_action</span><span class="p" data-group-id="1701400430-21">(</span><span class="k" data-group-id="1701400430-22">fn</span><span class="w"> </span><span class="n">changeset</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
  </span><span class="nc">IO</span><span class="o">.</span><span class="n">puts</span><span class="p" data-group-id="1701400430-23">(</span><span class="s">&quot;second after&quot;</span><span class="p" data-group-id="1701400430-23">)</span><span class="w">
  </span><span class="p" data-group-id="1701400430-24">{</span><span class="ss">:ok</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p" data-group-id="1701400430-24">}</span><span class="w">
</span><span class="k" data-group-id="1701400430-22">end</span><span class="p" data-group-id="1701400430-21">)</span></code></pre><p>This would print:</p><pre><code class="makeup elixir" translate="no"><span class="n">first</span><span class="w"> </span><span class="ss">around</span><span class="p">:</span><span class="w"> </span><span class="n">before</span><span class="w">
</span><span class="n">second</span><span class="w"> </span><span class="ss">around</span><span class="p">:</span><span class="w"> </span><span class="n">before</span><span class="w">
</span><span class="n">first</span><span class="w"> </span><span class="n">before</span><span class="w">
</span><span class="n">second</span><span class="w"> </span><span class="n">before</span><span class="w">
             </span><span class="o">&lt;-</span><span class="o">-</span><span class="w"> </span><span class="n">action</span><span class="w"> </span><span class="n">happens</span><span class="w"> </span><span class="n">here</span><span class="w">
</span><span class="n">first</span><span class="w"> </span><span class="k">after</span><span class="w">
</span><span class="n">second</span><span class="w"> </span><span class="k">after</span><span class="w">
</span><span class="n">second</span><span class="w"> </span><span class="ss">around</span><span class="p">:</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="o">&lt;-</span><span class="o">-</span><span class="w"> </span><span class="nc">Notice</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">callbacks</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">around</span><span class="w"> </span><span class="n">hooks</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">reversed</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">before</span><span class="w">
</span><span class="n">first</span><span class="w"> </span><span class="ss">around</span><span class="p">:</span><span class="w"> </span><span class="k">after</span></code></pre><p>Warning: using this without understanding how it works can cause big problems.
You <em>must</em> call the callback function that is provided to your hook, and the return value must
contain the same structure that was given to you, i.e <code class="inline">{:ok, result_of_action, instructions}</code>.</p><p>You can almost always get the same effect by using <code class="inline">before_action</code>, setting some context on the changeset
and reading it out in an <code class="inline">after_action</code> hook.</p>
  </section>
</section>
<section class="detail" id="around_transaction/2">

  <div class="detail-header">
    <a href="#around_transaction/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">around_transaction(changeset, func)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L5402" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> around_transaction(<a href="#t:t/0">t</a>(), <a href="#t:around_transaction_fun/0">around_transaction_fun</a>()) :: <a href="#t:t/0">t</a>()</pre>

      </div>

<p>Adds an around_transaction hook to the changeset.</p><p>Your function will get the changeset, and a callback that must be called with a changeset (that may be modified).
The callback will return <code class="inline">{:ok, result}</code> or <code class="inline">{:error, error}</code>. You can modify these values, but the return value
must be one of those types.</p><p>The around_transaction calls happen first, and then (after they each resolve their callbacks) the <code class="inline">before_transaction</code>
hooks are called, followed by the action hooks and then the <code class="inline">after_transaction</code> hooks being run.
Then, the code that appeared <em>after</em> the callbacks were called is then run.</p><p>For example:</p><pre><code class="makeup elixir" translate="no"><span class="n">changeset</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Ash.Changeset</span><span class="o">.</span><span class="n">around_transaction</span><span class="p" data-group-id="6858565955-1">(</span><span class="k" data-group-id="6858565955-2">fn</span><span class="w"> </span><span class="n">changeset</span><span class="p">,</span><span class="w"> </span><span class="n">callback</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
  </span><span class="nc">IO</span><span class="o">.</span><span class="n">puts</span><span class="p" data-group-id="6858565955-3">(</span><span class="s">&quot;first around: before&quot;</span><span class="p" data-group-id="6858565955-3">)</span><span class="w">
  </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">callback</span><span class="o">.</span><span class="p" data-group-id="6858565955-4">(</span><span class="n">changeset</span><span class="p" data-group-id="6858565955-4">)</span><span class="w">
  </span><span class="nc">IO</span><span class="o">.</span><span class="n">puts</span><span class="p" data-group-id="6858565955-5">(</span><span class="s">&quot;first around: after&quot;</span><span class="p" data-group-id="6858565955-5">)</span><span class="w">

  </span><span class="n">result</span><span class="w">
</span><span class="k" data-group-id="6858565955-2">end</span><span class="p" data-group-id="6858565955-1">)</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Ash.Changeset</span><span class="o">.</span><span class="n">around_transaction</span><span class="p" data-group-id="6858565955-6">(</span><span class="k" data-group-id="6858565955-7">fn</span><span class="w"> </span><span class="n">changeset</span><span class="p">,</span><span class="w"> </span><span class="n">callback</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
  </span><span class="nc">IO</span><span class="o">.</span><span class="n">puts</span><span class="p" data-group-id="6858565955-8">(</span><span class="s">&quot;second around: before&quot;</span><span class="p" data-group-id="6858565955-8">)</span><span class="w">
  </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">callback</span><span class="o">.</span><span class="p" data-group-id="6858565955-9">(</span><span class="n">changeset</span><span class="p" data-group-id="6858565955-9">)</span><span class="w">
  </span><span class="nc">IO</span><span class="o">.</span><span class="n">puts</span><span class="p" data-group-id="6858565955-10">(</span><span class="s">&quot;second around: after&quot;</span><span class="p" data-group-id="6858565955-10">)</span><span class="w">

  </span><span class="n">result</span><span class="w">
</span><span class="k" data-group-id="6858565955-7">end</span><span class="p" data-group-id="6858565955-6">)</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Ash.Changeset</span><span class="o">.</span><span class="n">before_transaction</span><span class="p" data-group-id="6858565955-11">(</span><span class="k" data-group-id="6858565955-12">fn</span><span class="w"> </span><span class="n">changeset</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
  </span><span class="nc">IO</span><span class="o">.</span><span class="n">puts</span><span class="p" data-group-id="6858565955-13">(</span><span class="s">&quot;first before&quot;</span><span class="p" data-group-id="6858565955-13">)</span><span class="w">
  </span><span class="n">changeset</span><span class="w">
</span><span class="k" data-group-id="6858565955-12">end</span><span class="p">,</span><span class="w"> </span><span class="ss">append?</span><span class="p">:</span><span class="w"> </span><span class="no">true</span><span class="p" data-group-id="6858565955-11">)</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Ash.Changeset</span><span class="o">.</span><span class="n">before_transaction</span><span class="p" data-group-id="6858565955-14">(</span><span class="k" data-group-id="6858565955-15">fn</span><span class="w"> </span><span class="n">changeset</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
  </span><span class="nc">IO</span><span class="o">.</span><span class="n">puts</span><span class="p" data-group-id="6858565955-16">(</span><span class="s">&quot;second before&quot;</span><span class="p" data-group-id="6858565955-16">)</span><span class="w">
  </span><span class="n">changeset</span><span class="w">
</span><span class="k" data-group-id="6858565955-15">end</span><span class="p">,</span><span class="w"> </span><span class="ss">append?</span><span class="p">:</span><span class="w"> </span><span class="no">true</span><span class="p" data-group-id="6858565955-14">)</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Ash.Changeset</span><span class="o">.</span><span class="n">after_transaction</span><span class="p" data-group-id="6858565955-17">(</span><span class="k" data-group-id="6858565955-18">fn</span><span class="w"> </span><span class="n">changeset</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
  </span><span class="nc">IO</span><span class="o">.</span><span class="n">puts</span><span class="p" data-group-id="6858565955-19">(</span><span class="s">&quot;first after&quot;</span><span class="p" data-group-id="6858565955-19">)</span><span class="w">
  </span><span class="n">result</span><span class="w">
</span><span class="k" data-group-id="6858565955-18">end</span><span class="p" data-group-id="6858565955-17">)</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Ash.Changeset</span><span class="o">.</span><span class="n">after_transaction</span><span class="p" data-group-id="6858565955-20">(</span><span class="k" data-group-id="6858565955-21">fn</span><span class="w"> </span><span class="n">changeset</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
  </span><span class="nc">IO</span><span class="o">.</span><span class="n">puts</span><span class="p" data-group-id="6858565955-22">(</span><span class="s">&quot;second after&quot;</span><span class="p" data-group-id="6858565955-22">)</span><span class="w">
  </span><span class="n">result</span><span class="w">
</span><span class="k" data-group-id="6858565955-21">end</span><span class="p" data-group-id="6858565955-20">)</span></code></pre><p>This would print:</p><pre><code class="makeup elixir" translate="no"><span class="n">first</span><span class="w"> </span><span class="ss">around</span><span class="p">:</span><span class="w"> </span><span class="n">before</span><span class="w">
</span><span class="n">second</span><span class="w"> </span><span class="ss">around</span><span class="p">:</span><span class="w"> </span><span class="n">before</span><span class="w">
</span><span class="n">first</span><span class="w"> </span><span class="n">before</span><span class="w">
</span><span class="n">second</span><span class="w"> </span><span class="n">before</span><span class="w">
             </span><span class="o">&lt;-</span><span class="o">-</span><span class="w"> </span><span class="n">action</span><span class="w"> </span><span class="n">hooks</span><span class="w"> </span><span class="n">happens</span><span class="w"> </span><span class="n">here</span><span class="w">
</span><span class="n">first</span><span class="w"> </span><span class="k">after</span><span class="w">
</span><span class="n">second</span><span class="w"> </span><span class="k">after</span><span class="w">
</span><span class="n">second</span><span class="w"> </span><span class="ss">around</span><span class="p">:</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="o">&lt;-</span><span class="o">-</span><span class="w"> </span><span class="nc">Notice</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">callbacks</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">around</span><span class="w"> </span><span class="n">hooks</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">reversed</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">before</span><span class="w">
</span><span class="n">first</span><span class="w"> </span><span class="ss">around</span><span class="p">:</span><span class="w"> </span><span class="k">after</span></code></pre><p>Warning: using this without understanding how it works can cause big problems.
You <em>must</em> call the callback function that is provided to your hook, and the return value must
contain the same structure that was given to you, i.e <code class="inline">{:ok, result_of_action}</code>.</p><p>You can almost always get the same effect by using <code class="inline">before_transaction</code>, setting some context on the changeset
and reading it out in an <code class="inline">after_transaction</code> hook.</p>
  </section>
</section>
<section class="detail" id="atomic_ref/2">

  <div class="detail-header">
    <a href="#atomic_ref/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">atomic_ref(changeset, field)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L926" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Gets a reference to a field, or the current atomic update expression of that field.</p>
  </section>
</section>
<section class="detail" id="atomic_update/2">

  <div class="detail-header">
    <a href="#atomic_update/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">atomic_update(changeset, atomics)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L1476" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> atomic_update(<a href="#t:t/0">t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">map</a>() | <a href="https://hexdocs.pm/elixir/Keyword.html#t:t/0">Keyword.t</a>()) :: <a href="#t:t/0">t</a>()</pre>

      </div>

<p>Adds multiple atomic changes to the changeset</p><p>See <a href="#atomic_update/3"><code class="inline">atomic_update/3</code></a> for more information.</p>
  </section>
</section>
<section class="detail" id="atomic_update/3">

  <div class="detail-header">
    <a href="#atomic_update/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">atomic_update(changeset, key, value)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L1523" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> atomic_update(<a href="#t:t/0">t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>(), {:atomic, <a href="Ash.Expr.html#t:t/0">Ash.Expr.t</a>()} | <a href="Ash.Expr.html#t:t/0">Ash.Expr.t</a>()) :: <a href="#t:t/0">t</a>()</pre>

      </div>

<p>Adds an atomic change to the changeset.</p><p>Atomic changes are applied by the data layer, and as such have guarantees that are not
given by changes that are based on looking at the previous value and updating it. Here
is an example of a change that is not safe to do concurrently:</p><pre><code class="makeup elixir" translate="no"><span class="n">change</span><span class="w"> </span><span class="k" data-group-id="0924013886-1">fn</span><span class="w"> </span><span class="n">changeset</span><span class="p">,</span><span class="w"> </span><span class="bp">_</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
  </span><span class="nc">Ash.Changeset</span><span class="o">.</span><span class="n">change_attribute</span><span class="p" data-group-id="0924013886-2">(</span><span class="n">changeset</span><span class="p">,</span><span class="w"> </span><span class="ss">:score</span><span class="p">,</span><span class="w"> </span><span class="n">changeset</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">score</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="0924013886-2">)</span><span class="w">
</span><span class="k" data-group-id="0924013886-1">end</span></code></pre><p>If two processes run this concurrently, they will both read the same value of <code class="inline">score</code>, and
set the new score to the same value. This means that one of the increments will be lost.
If you were to instead do this using <code class="inline">atomic_update</code>, you would get the correct result:</p><pre><code class="makeup elixir" translate="no"><span class="nc">Ash.Changeset</span><span class="o">.</span><span class="n">atomic_update</span><span class="p" data-group-id="1939643303-1">(</span><span class="n">changeset</span><span class="p">,</span><span class="w"> </span><span class="ss">:score</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1939643303-2">[</span><span class="n">expr</span><span class="p" data-group-id="1939643303-3">(</span><span class="n">score</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="1939643303-3">)</span><span class="p" data-group-id="1939643303-2">]</span><span class="p" data-group-id="1939643303-1">)</span></code></pre><p>There are drawbacks/things to consider, however. The first is that atomic update results
are not known until after the action is run. The following functional validation would not
be able to enforce the score being less than 10, because the atomic happens after the validation.</p><pre><code class="makeup elixir" translate="no"><span class="n">validate</span><span class="w"> </span><span class="k" data-group-id="0105488396-1">fn</span><span class="w"> </span><span class="n">changeset</span><span class="p">,</span><span class="w"> </span><span class="bp">_</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
  </span><span class="k">if</span><span class="w"> </span><span class="nc">Ash.Changeset</span><span class="o">.</span><span class="n">get_attribute</span><span class="p" data-group-id="0105488396-2">(</span><span class="n">changeset</span><span class="p">,</span><span class="w"> </span><span class="ss">:score</span><span class="p" data-group-id="0105488396-2">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="k" data-group-id="0105488396-3">do</span><span class="w">
    </span><span class="ss">:ok</span><span class="w">
  </span><span class="k" data-group-id="0105488396-3">else</span><span class="w">
    </span><span class="p" data-group-id="0105488396-4">{</span><span class="ss">:error</span><span class="p">,</span><span class="w"> </span><span class="ss">field</span><span class="p">:</span><span class="w"> </span><span class="ss">:score</span><span class="p">,</span><span class="w"> </span><span class="ss">message</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;must be less than 10&quot;</span><span class="p" data-group-id="0105488396-4">}</span><span class="w">
  </span><span class="k" data-group-id="0105488396-3">end</span><span class="w">
</span><span class="k" data-group-id="0105488396-1">end</span></code></pre><p>If you want to use atomic updates, it is suggested to write module-based validations &amp; changes,
and implement the appropriate atomic callbacks on those modules. All builtin validations and changes
implement these callbacks in addition to the standard callbacks. Validations will only be run atomically
when the entire action is being run atomically or if one of the relevant fields is being updated atomically.</p>
  </section>
</section>
<section class="detail" id="attribute_present?/2">

  <div class="detail-header">
    <a href="#attribute_present?/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">attribute_present?(changeset, attribute)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L1814" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Checks if an attribute is not nil, either in the original data, or that it is not being changed to a <code class="inline">nil</code> value if it is changing.</p><p>This also accounts for the <code class="inline">accessing_from</code> context that is set when using <code class="inline">manage_relationship</code>, so it is aware that a particular value
<em>will</em> be set by <code class="inline">manage_relationship</code> even if it isn't currently being set.</p>
  </section>
</section>
<section class="detail" id="before_action/3">

    <span id="before_action/2"></span>

  <div class="detail-header">
    <a href="#before_action/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">before_action(changeset, func, opts \\ [])</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L5159" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> before_action(
  changeset :: <a href="#t:t/0">t</a>(),
  fun :: <a href="#t:before_action_fun/0">before_action_fun</a>(),
  opts :: <a href="https://hexdocs.pm/elixir/Keyword.html#t:t/0">Keyword.t</a>()
) :: <a href="#t:t/0">t</a>()</pre>

      </div>

<p>Adds a before_action hook to the changeset.</p><p>Provide the option <code class="inline">prepend?: true</code> to place the hook before all
other hooks instead of after.</p>
  </section>
</section>
<section class="detail" id="before_transaction/3">

    <span id="before_transaction/2"></span>

  <div class="detail-header">
    <a href="#before_transaction/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">before_transaction(changeset, func, opts \\ [])</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L5180" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> before_transaction(
  <a href="#t:t/0">t</a>(),
  <a href="#t:before_transaction_fun/0">before_transaction_fun</a>(),
  <a href="https://hexdocs.pm/elixir/Keyword.html#t:t/0">Keyword.t</a>()
) :: <a href="#t:t/0">t</a>()</pre>

      </div>

<p>Adds a before_transaction hook to the changeset.</p><p>Provide the option <code class="inline">prepend?: true</code> to place the hook before all
other hooks instead of after.</p>
  </section>
</section>
<section class="detail" id="change_attribute/3">

  <div class="detail-header">
    <a href="#change_attribute/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">change_attribute(changeset, attribute, value)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L4911" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> change_attribute(<a href="#t:t/0">t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">any</a>()) :: <a href="#t:t/0">t</a>()</pre>

      </div>

<p>Adds a change to the changeset, unless the value matches the existing value.</p>
  </section>
</section>
<section class="detail" id="change_attributes/2">

  <div class="detail-header">
    <a href="#change_attributes/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">change_attributes(changeset, changes)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L4901" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> change_attributes(<a href="#t:t/0">t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">map</a>() | <a href="https://hexdocs.pm/elixir/Keyword.html#t:t/0">Keyword.t</a>()) :: <a href="#t:t/0">t</a>()</pre>

      </div>

<p>Calls <a href="#change_attribute/3"><code class="inline">change_attribute/3</code></a> for each key/value pair provided.</p>
  </section>
</section>
<section class="detail" id="change_default_attribute/3">

  <div class="detail-header">
    <a href="#change_default_attribute/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">change_default_attribute(changeset, attribute, value)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L5021" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> change_default_attribute(<a href="#t:t/0">t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">any</a>()) :: <a href="#t:t/0">t</a>()</pre>

      </div>

<p>The same as <code class="inline">change_attribute</code>, but annotates that the attribute is currently holding a default value.</p><p>This information can be used in changes to see if a value was explicitly set or if it was set by being the default.
Additionally, this is used in <code class="inline">upsert</code> actions to not overwrite existing values with the default.</p>
  </section>
</section>
<section class="detail" id="change_new_attribute/3">

  <div class="detail-header">
    <a href="#change_new_attribute/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">change_new_attribute(changeset, attribute, value)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L4707" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> change_new_attribute(<a href="#t:t/0">t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>()) :: <a href="#t:t/0">t</a>()</pre>

      </div>

<p>Change an attribute only if is not currently being changed</p>
  </section>
</section>
<section class="detail" id="change_new_attribute_lazy/3">

  <div class="detail-header">
    <a href="#change_new_attribute_lazy/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">change_new_attribute_lazy(changeset, attribute, func)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L4724" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> change_new_attribute_lazy(<a href="#t:t/0">t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>(), (-&gt; <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">any</a>())) :: <a href="#t:t/0">t</a>()</pre>

      </div>

<p>Change an attribute if is not currently being changed, by calling the provided function.</p><p>Use this if you want to only perform some expensive calculation for an attribute value
only if there isn't already a change for that attribute.</p>
  </section>
</section>
<section class="detail" id="changing_attribute?/2">

  <div class="detail-header">
    <a href="#changing_attribute?/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">changing_attribute?(changeset, attribute)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L4694" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> changing_attribute?(<a href="#t:t/0">t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>()) :: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">boolean</a>()</pre>

      </div>

<p>Returns true if an attribute exists in the changes</p>
  </section>
</section>
<section class="detail" id="changing_attributes?/1">

  <div class="detail-header">
    <a href="#changing_attributes?/1" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">changing_attributes?(changeset)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L4686" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> changing_attributes?(<a href="#t:t/0">t</a>()) :: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">boolean</a>()</pre>

      </div>

<p>Returns true if any attributes on the resource are being changed.</p>
  </section>
</section>
<section class="detail" id="changing_relationship?/2">

  <div class="detail-header">
    <a href="#changing_relationship?/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">changing_relationship?(changeset, relationship)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L4701" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> changing_relationship?(<a href="#t:t/0">t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>()) :: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">boolean</a>()</pre>

      </div>

<p>Returns true if a relationship exists in the changes</p>
  </section>
</section>
<section class="detail" id="clear_change/2">

  <div class="detail-header">
    <a href="#clear_change/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">clear_change(changeset, field)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L5447" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Clears an attribute or relationship change off of the changeset.</p>
  </section>
</section>
<section class="detail" id="delete_argument/2">

  <div class="detail-header">
    <a href="#delete_argument/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">delete_argument(changeset, argument_or_arguments)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L4841" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Remove an argument from the changeset</p>
  </section>
</section>
<section class="detail" id="deselect/2">

  <div class="detail-header">
    <a href="#deselect/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">deselect(changeset, fields)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L491" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Ensure the the specified attributes are <code class="inline">nil</code> in the changeset results.</p>
  </section>
</section>
<section class="detail" id="ensure_selected/2">

  <div class="detail-header">
    <a href="#ensure_selected/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">ensure_selected(changeset, fields)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L475" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Ensures that the given attributes are selected.</p><p>The first call to <a href="#select/2"><code class="inline">select/2</code></a> will <em>limit</em> the fields to only the provided fields.
Use <a href="#ensure_selected/2"><code class="inline">ensure_selected/2</code></a> to say &quot;select this field (or these fields) without deselecting anything else&quot;.</p><p>See <a href="#select/2"><code class="inline">select/2</code></a> for more.</p>
  </section>
</section>
<section class="detail" id="expand_upsert_fields/2">

  <div class="detail-header">
    <a href="#expand_upsert_fields/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">expand_upsert_fields(fields, resource)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L1606" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Turns the special case {:replace, fields}, :replace_all and {:replace_all_except, fields} upsert_fields
options into a list of fields</p>
  </section>
</section>
<section class="detail" id="fetch_argument/2">

  <div class="detail-header">
    <a href="#fetch_argument/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">fetch_argument(changeset, argument)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L3804" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> fetch_argument(<a href="#t:t/0">t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>()) :: {:ok, <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>()} | :error</pre>

      </div>

<p>Fetches the value of an argument provided to the changeset or <code class="inline">:error</code>.</p>
  </section>
</section>
<section class="detail" id="fetch_argument_or_change/2">

  <div class="detail-header">
    <a href="#fetch_argument_or_change/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">fetch_argument_or_change(changeset, attribute)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L3860" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> fetch_argument_or_change(<a href="#t:t/0">t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>()) :: {:ok, <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">any</a>()} | :error</pre>

      </div>

<p>Gets the value of an argument provided to the changeset, falling back to <a href="#fetch_change/2"><code class="inline">Ash.Changeset.fetch_change/2</code></a> if nothing was provided.</p>
  </section>
</section>
<section class="detail" id="fetch_change/2">

  <div class="detail-header">
    <a href="#fetch_change/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">fetch_change(changeset, attribute)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L3854" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> fetch_change(<a href="#t:t/0">t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>()) :: {:ok, <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">any</a>()} | :error</pre>

      </div>

<p>Gets the new value for an attribute, or <code class="inline">:error</code> if it is not being changed.</p>
  </section>
</section>
<section class="detail" id="filter/2">

  <div class="detail-header">
    <a href="#filter/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">filter(changeset, expr)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L5492" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> filter(<a href="#t:t/0">t</a>(), <a href="Ash.Expr.html#t:t/0">Ash.Expr.t</a>()) :: <a href="#t:t/0">t</a>()</pre>

      </div>

<p>Adds a filter for a record being updated or destroyed.</p><p>Used by optimistic locking. See <a href="Ash.Resource.Change.Builtins.html#optimistic_lock/1"><code class="inline">Ash.Resource.Change.Builtins.optimistic_lock/1</code></a> for more.</p>
  </section>
</section>
<section class="detail" id="for_action/4">

    <span id="for_action/2"></span>

    <span id="for_action/3"></span>

  <div class="detail-header">
    <a href="#for_action/4" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">for_action(initial, action, params \\ %{}, opts \\ [])</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L1118" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Constructs a changeset for a given action, and validates it.</p><p>Calls <a href="#for_create/4"><code class="inline">for_create/4</code></a>, <a href="#for_update/4"><code class="inline">for_update/4</code></a> or <a href="#for_destroy/4"><code class="inline">for_destroy/4</code></a> based on the type of action passed in.</p><p>See those functions for more explanation.</p>
  </section>
</section>
<section class="detail" id="for_create/4">

    <span id="for_create/2"></span>

    <span id="for_create/3"></span>

  <div class="detail-header">
    <a href="#for_create/4" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">for_create(initial, action, params \\ %{}, opts \\ [])</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L1232" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Constructs a changeset for a given create action, and validates it.</p><p>Anything that is modified prior to <a href="#for_create/4"><code class="inline">for_create/4</code></a> is validated against the rules of the action, while <em>anything after it is not</em>.
This runs any <code class="inline">change</code>s contained on your action. To have your logic execute <em>only</em> during the action, you can use <a href="#after_action/2"><code class="inline">after_action/2</code></a>
or <a href="#before_action/2"><code class="inline">before_action/2</code></a>.</p><p>Multitenancy is <em>not</em> validated until an action is called. This allows you to avoid specifying a tenant until just before calling
the domain action.</p><h3 id="for_create/4-params" class="section-heading">
  <a href="#for_create/4-params" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Params</span>
</h3>
<p><code class="inline">params</code> may be attributes, relationships, or arguments. You can safely pass user/form input directly into this function.
Only public attributes and relationships are supported. If you want to change private attributes as well, see the
Customization section below. <code class="inline">params</code> are stored directly as given in the <code class="inline">params</code> field of the changeset, which is used</p><h3 id="for_create/4-opts" class="section-heading">
  <a href="#for_create/4-opts" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Opts</span>
</h3>
<ul><li><p><code class="inline">:require?</code> (<a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types"><code class="inline">boolean/0</code></a>) - If set to <code class="inline">false</code>, values are only required when the action is run (instead of immediately). The default value is <code class="inline">false</code>.</p></li><li><p><code class="inline">:actor</code> (<a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types"><code class="inline">term/0</code></a>) - set the actor, which can be used in any <a href="Ash.Resource.Change.html"><code class="inline">Ash.Resource.Change</code></a>s configured on the action. (in the <code class="inline">context</code> argument)</p></li><li><p><code class="inline">:authorize?</code> (<a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types"><code class="inline">term/0</code></a>) - set authorize?, which can be used in any <a href="Ash.Resource.Change.html"><code class="inline">Ash.Resource.Change</code></a>s configured on the action. (in the <code class="inline">context</code> argument)</p></li><li><p><code class="inline">:tracer</code> (one or a list of module that adopts <a href="Ash.Tracer.html"><code class="inline">Ash.Tracer</code></a>) - A tracer to use. Will be carried over to the action. For more information see <a href="Ash.Tracer.html"><code class="inline">Ash.Tracer</code></a>.</p></li><li><p><code class="inline">:tenant</code> (value that implements the <a href="Ash.ToTenant.html"><code class="inline">Ash.ToTenant</code></a> protocol) - set the tenant on the changeset</p></li><li><p><code class="inline">:skip_unknown_inputs</code> - A list of inputs that, if provided, will be ignored if they are not recognized by the action. Use <code class="inline">:*</code> to indicate all unknown keys.</p></li><li><p><code class="inline">:context</code> (<a href="https://hexdocs.pm/elixir/typespecs.html#basic-types"><code class="inline">map/0</code></a>) - Context to set on the query, changeset, or input</p></li></ul><h3 id="for_create/4-customization" class="section-heading">
  <a href="#for_create/4-customization" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Customization</span>
</h3>
<p>A changeset can be provided as the first argument, instead of a resource, to allow
setting specific attributes ahead of time.</p><p>For example:</p><pre><code class="makeup elixir" translate="no"><span class="nc">MyResource</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Ash.Changeset</span><span class="o">.</span><span class="n">new</span><span class="p" data-group-id="7794313477-1">(</span><span class="p" data-group-id="7794313477-1">)</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Ash.Changeset</span><span class="o">.</span><span class="n">change_attribute</span><span class="p" data-group-id="7794313477-2">(</span><span class="ss">:foo</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="7794313477-2">)</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Ash.Changeset</span><span class="o">.</span><span class="n">for_create</span><span class="p" data-group-id="7794313477-3">(</span><span class="ss">:create</span><span class="p">,</span><span class="w"> </span><span class="n">...</span><span class="n">opts</span><span class="p" data-group-id="7794313477-3">)</span></code></pre><p>Once a changeset has been validated by <a href="#for_create/4"><code class="inline">for_create/4</code></a> (or <a href="#for_update/4"><code class="inline">for_update/4</code></a>), it isn't validated again in the action.
New changes added are validated individually, though. This allows you to create a changeset according
to a given action, and then add custom changes if necessary.</p><h3 id="for_create/4-what-does-this-function-do" class="section-heading">
  <a href="#for_create/4-what-does-this-function-do" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">What does this function do?</span>
</h3>
<p>The following steps are run when calling <a href="#for_create/4"><code class="inline">Ash.Changeset.for_create/4</code></a>.</p><ul><li><p>Cast input params | This is any arguments in addition to any accepted attributes</p></li><li>Set argument defaults</li><li>Require any missing arguments</li><li>Validate all provided attributes are accepted</li><li>Require any accepted attributes that are <code class="inline">allow_nil?</code> false</li><li>Set any default values for attributes</li><li>Run action changes &amp; validations</li><li>Run validations, or add them in <code class="inline">before_action</code> hooks if using <code class="inline"><a href="dsl-ash-resource.html#actions-create-validate-before_action?">Ash.Resource.Dsl.actions.create.validate.before_action?</a></code>. Any global validations are skipped if the action has <code class="inline">skip_global_validations?</code> set to <code class="inline">true</code>.</li></ul>
  </section>
</section>
<section class="detail" id="for_destroy/4">

    <span id="for_destroy/2"></span>

    <span id="for_destroy/3"></span>

  <div class="detail-header">
    <a href="#for_destroy/4" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">for_destroy(initial, action_or_name, params \\ %{}, opts \\ [])</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L1365" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Constructs a changeset for a given destroy action, and validates it.</p><h3 id="for_destroy/4-opts" class="section-heading">
  <a href="#for_destroy/4-opts" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Opts</span>
</h3>
<ul><li><code class="inline">:actor</code> - set the actor, which can be used in any <a href="Ash.Resource.Change.html"><code class="inline">Ash.Resource.Change</code></a>s configured on the action. (in the <code class="inline">context</code> argument)</li><li><code class="inline">:tenant</code> - set the tenant on the changeset</li></ul><p>Anything that is modified prior to <a href="#for_destroy/4"><code class="inline">for_destroy/4</code></a> is validated against the rules of the action, while <em>anything after it is not</em>.</p><p>Once a changeset has been validated by <a href="#for_destroy/4"><code class="inline">for_destroy/4</code></a>, it isn't validated again in the action.
New changes added are validated individually, though. This allows you to create a changeset according
to a given action, and then add custom changes if necessary.</p><h3 id="for_destroy/4-what-does-this-function-do" class="section-heading">
  <a href="#for_destroy/4-what-does-this-function-do" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">What does this function do?</span>
</h3>
<p>The following steps are run when calling <a href="#for_destroy/4"><code class="inline">Ash.Changeset.for_destroy/4</code></a>.</p><ul><li><p>Cast input params | This is any arguments in addition to any accepted attributes</p></li><li>Set argument defaults</li><li>Require any missing arguments</li><li>Validate all provided attributes are accepted</li><li>Require any accepted attributes that are <code class="inline">allow_nil?</code> false</li><li>Set any default values for attributes</li><li>Run action changes &amp; validations</li><li>Run validations, or add them in <code class="inline">before_action</code> hooks if using <code class="inline"><a href="dsl-ash-resource.html#actions-destroy-validate-before_action?">Ash.Resource.Dsl.actions.destroy.validate.before_action?</a></code>. Any global validations are skipped if the action has <code class="inline">skip_global_validations?</code> set to <code class="inline">true</code>.</li></ul>
  </section>
</section>
<section class="detail" id="for_update/4">

    <span id="for_update/2"></span>

    <span id="for_update/3"></span>

  <div class="detail-header">
    <a href="#for_update/4" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">for_update(initial, action, params \\ %{}, opts \\ [])</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L1316" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Constructs a changeset for a given update action, and validates it.</p><p>Anything that is modified prior to <a href="#for_update/4"><code class="inline">for_update/4</code></a> is validated against the rules of the action, while <em>anything after it is not</em>.</p><h3 id="for_update/4-what-does-this-function-do" class="section-heading">
  <a href="#for_update/4-what-does-this-function-do" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">What does this function do?</span>
</h3>
<p>The following steps are run when calling <a href="#for_update/4"><code class="inline">Ash.Changeset.for_update/4</code></a>.</p><ul><li><p>Cast input params | This is any arguments in addition to any accepted attributes</p></li><li>Set argument defaults</li><li>Require any missing arguments</li><li>Validate all provided attributes are accepted</li><li>Require any accepted attributes that are <code class="inline">allow_nil?</code> false</li><li>Set any default values for attributes</li><li>Run action changes &amp; validations</li><li>Run validations, or add them in <code class="inline">before_action</code> hooks if using <code class="inline"><a href="dsl-ash-resource.html#actions-update-validate-before_action?">Ash.Resource.Dsl.actions.update.validate.before_action?</a></code>. Any global validations are skipped if the action has <code class="inline">skip_global_validations?</code> set to <code class="inline">true</code>.</li></ul>
  </section>
</section>
<section class="detail" id="force_change_attribute/3">

  <div class="detail-header">
    <a href="#force_change_attribute/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">force_change_attribute(changeset, attribute, value)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L5053" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> force_change_attribute(<a href="#t:t/0">t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">any</a>()) :: <a href="#t:t/0">t</a>()</pre>

      </div>

<p>Changes an attribute even if it isn't writable</p>
  </section>
</section>
<section class="detail" id="force_change_attributes/2">

  <div class="detail-header">
    <a href="#force_change_attributes/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">force_change_attributes(changeset, changes)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L5045" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> force_change_attributes(<a href="#t:t/0">t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">map</a>() | <a href="https://hexdocs.pm/elixir/Keyword.html#t:t/0">Keyword.t</a>()) :: <a href="#t:t/0">t</a>()</pre>

      </div>

<p>Calls <a href="#force_change_attribute/3"><code class="inline">force_change_attribute/3</code></a> for each key/value pair provided.</p>
  </section>
</section>
<section class="detail" id="force_change_new_attribute/3">

  <div class="detail-header">
    <a href="#force_change_new_attribute/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">force_change_new_attribute(changeset, attribute, value)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L4877" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> force_change_new_attribute(<a href="#t:t/0">t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>()) :: <a href="#t:t/0">t</a>()</pre>

      </div>

<p>Force change an attribute if it is not currently being changed.</p><p>See <a href="#change_new_attribute/3"><code class="inline">change_new_attribute/3</code></a> for more.</p>
  </section>
</section>
<section class="detail" id="force_change_new_attribute_lazy/3">

  <div class="detail-header">
    <a href="#force_change_new_attribute_lazy/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">force_change_new_attribute_lazy(changeset, attribute, func)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L4891" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> force_change_new_attribute_lazy(<a href="#t:t/0">t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>(), (-&gt; <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">any</a>())) :: <a href="#t:t/0">t</a>()</pre>

      </div>

<p>Force change an attribute if it is not currently being changed, by calling the provided function.</p><p>See <a href="#change_new_attribute_lazy/3"><code class="inline">change_new_attribute_lazy/3</code></a> for more.</p>
  </section>
</section>
<section class="detail" id="force_set_argument/3">

  <div class="detail-header">
    <a href="#force_set_argument/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">force_set_argument(changeset, argument, value)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L4782" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Add an argument to the changeset, which will be provided to the action.</p><p>Does not show a warning when used in before/after action hooks.</p>
  </section>
</section>
<section class="detail" id="force_set_arguments/2">

  <div class="detail-header">
    <a href="#force_set_arguments/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">force_set_arguments(changeset, map)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L4865" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Merge a map of arguments to the arguments list.</p><p>Does not show a warning when used in before/after action hooks.</p>
  </section>
</section>
<section class="detail" id="fully_atomic_changeset/4">

    <span id="fully_atomic_changeset/3"></span>

  <div class="detail-header">
    <a href="#fully_atomic_changeset/4" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">fully_atomic_changeset(resource, action, params, opts \\ [])</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L566" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> fully_atomic_changeset(
  resource :: <a href="Ash.Resource.html#t:t/0">Ash.Resource.t</a>(),
  action :: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>() | <a href="Ash.Resource.Actions.html#t:action/0">Ash.Resource.Actions.action</a>(),
  params :: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">map</a>(),
  opts :: <a href="https://hexdocs.pm/elixir/Keyword.html#t:t/0">Keyword.t</a>()
) :: <a href="#t:t/0">t</a>() | {:not_atomic, <a href="https://hexdocs.pm/elixir/String.html#t:t/0">String.t</a>()}</pre>

      </div>


  </section>
</section>
<section class="detail" id="get_argument/2">

  <div class="detail-header">
    <a href="#get_argument/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">get_argument(changeset, argument)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L3780" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> get_argument(<a href="#t:t/0">t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>()) :: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>()</pre>

      </div>

<p>Gets the value of an argument provided to the changeset.</p>
  </section>
</section>
<section class="detail" id="get_argument_or_attribute/2">

  <div class="detail-header">
    <a href="#get_argument_or_attribute/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">get_argument_or_attribute(changeset, attribute)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L3845" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> get_argument_or_attribute(<a href="#t:t/0">t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>()) :: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>()</pre>

      </div>

<p>Gets the value of an argument provided to the changeset, falling back to <a href="#get_attribute/2"><code class="inline">Ash.Changeset.get_attribute/2</code></a> if nothing was provided.</p>
  </section>
</section>
<section class="detail" id="get_attribute/2">

  <div class="detail-header">
    <a href="#get_attribute/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">get_attribute(changeset, attribute)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L3833" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> get_attribute(<a href="#t:t/0">t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>()) :: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>()</pre>

      </div>

<p>Gets the changing value or the original value of an attribute.</p>
  </section>
</section>
<section class="detail" id="get_data/2">

  <div class="detail-header">
    <a href="#get_data/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">get_data(changeset, attribute)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L3869" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> get_data(<a href="#t:t/0">t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>()) :: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>()</pre>

      </div>

<p>Gets the original value for an attribute</p>
  </section>
</section>
<section class="detail" id="handle_errors/2">

  <div class="detail-header">
    <a href="#handle_errors/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">handle_errors(changeset, func)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L5478" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> handle_errors(
  <a href="#t:t/0">t</a>(),
  (<a href="#t:t/0">t</a>(), error :: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>() -&gt;
     :ignore | <a href="#t:t/0">t</a>() | (error :: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>()) | {error :: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>(), <a href="#t:t/0">t</a>()})
  | {<a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">module</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>(), [<a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>()]}
) :: <a href="#t:t/0">t</a>()</pre>

      </div>

<p>Sets a custom error handler on the changeset.</p><p>The error handler should be a two argument function or an mfa, in which case the first two arguments will be set
to the changeset and the error, w/ the supplied arguments following those.</p><p>Any errors generated are passed to <code class="inline">handle_errors</code>, which can return any of the following:</p><ul><li><code class="inline">:ignore</code> - the error is discarded, and the changeset is not marked as invalid</li><li><code class="inline">changeset</code> - a new (or the same) changeset. The error is not added (you'll want to add an error yourself), but the changeset <em>is</em> marked as invalid.</li><li><code class="inline">{changeset, error}</code> - a new (or the same) error and changeset. The error is added to the changeset, and the changeset is marked as invalid.</li><li><code class="inline">anything_else</code> - is treated as a new, transformed version of the error. The result is added as an error to the changeset, and the changeset is marked as invalid.</li></ul>
  </section>
</section>
<section class="detail" id="handle_params/4">

    <span id="handle_params/3"></span>

  <div class="detail-header">
    <a href="#handle_params/4" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">handle_params(changeset, action, params, handle_params_opts \\ [])</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L1853" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">


  </section>
</section>
<section class="detail" id="is_valid/1">

  <div class="detail-header">
    <a href="#is_valid/1" class="detail-link" data-no-tooltip title="Link to this macro">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this macro</span>
    </a>
    <h1 class="signature" translate="no">is_valid(changeset)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L369" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


      <span class="note">(macro)</span>

  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> is_valid(<a href="#t:t/0">t</a>()) :: <a href="https://hexdocs.pm/elixir/Macro.html#t:output/0">Macro.output</a>()</pre>

      </div>

<p>A guard which checks if the Changeset is valid.</p>
  </section>
</section>
<section class="detail" id="load/2">

  <div class="detail-header">
    <a href="#load/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">load(changeset, load)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L451" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> load(<a href="#t:t/0">t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>()) :: <a href="#t:t/0">t</a>()</pre>

      </div>

<p>Calls the provided load statement on the result of the action at the very end of the action.</p>
  </section>
</section>
<section class="detail" id="loading?/2">

  <div class="detail-header">
    <a href="#loading?/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">loading?(changeset, path)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L536" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Returns true if the field/relationship or path to field/relationship is being loaded.</p><p>It accepts an atom or a list of atoms, which is treated for as a &quot;path&quot;, i.e:</p><pre><code class="makeup elixir" translate="no"><span class="nc">Resource</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Ash.Changeset</span><span class="o">.</span><span class="n">load</span><span class="p" data-group-id="9248788565-1">(</span><span class="ss">friends</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="9248788565-2">[</span><span class="ss">enemies</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="9248788565-3">[</span><span class="ss">:score</span><span class="p" data-group-id="9248788565-3">]</span><span class="p" data-group-id="9248788565-2">]</span><span class="p" data-group-id="9248788565-1">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Ash.Changeset</span><span class="o">.</span><span class="n">loading?</span><span class="p" data-group-id="9248788565-4">(</span><span class="p" data-group-id="9248788565-5">[</span><span class="ss">:friends</span><span class="p">,</span><span class="w"> </span><span class="ss">:enemies</span><span class="p">,</span><span class="w"> </span><span class="ss">:score</span><span class="p" data-group-id="9248788565-5">]</span><span class="p" data-group-id="9248788565-4">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="no">true</span><span class="w">

</span><span class="nc">Resource</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Ash.Changeset</span><span class="o">.</span><span class="n">load</span><span class="p" data-group-id="9248788565-6">(</span><span class="ss">friends</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="9248788565-7">[</span><span class="ss">enemies</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="9248788565-8">[</span><span class="ss">:score</span><span class="p" data-group-id="9248788565-8">]</span><span class="p" data-group-id="9248788565-7">]</span><span class="p" data-group-id="9248788565-6">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Ash.Changeset</span><span class="o">.</span><span class="n">loading?</span><span class="p" data-group-id="9248788565-9">(</span><span class="p" data-group-id="9248788565-10">[</span><span class="ss">:friends</span><span class="p">,</span><span class="w"> </span><span class="ss">:score</span><span class="p" data-group-id="9248788565-10">]</span><span class="p" data-group-id="9248788565-9">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="no">false</span><span class="w">

</span><span class="nc">Resource</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Ash.Changeset</span><span class="o">.</span><span class="n">load</span><span class="p" data-group-id="9248788565-11">(</span><span class="ss">friends</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="9248788565-12">[</span><span class="ss">enemies</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="9248788565-13">[</span><span class="ss">:score</span><span class="p" data-group-id="9248788565-13">]</span><span class="p" data-group-id="9248788565-12">]</span><span class="p" data-group-id="9248788565-11">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Ash.Changeset</span><span class="o">.</span><span class="n">loading?</span><span class="p" data-group-id="9248788565-14">(</span><span class="ss">:friends</span><span class="p" data-group-id="9248788565-14">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="no">true</span></code></pre>
  </section>
</section>
<section class="detail" id="manage_relationship/4">

    <span id="manage_relationship/3"></span>

  <div class="detail-header">
    <a href="#manage_relationship/4" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">manage_relationship(changeset, relationship, input, opts \\ [])</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L4306" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Manages the related records by creating, updating, or destroying them as necessary.</p><p>Keep in mind that the default values for all <code class="inline">on_*</code> are <code class="inline">:ignore</code>, meaning nothing will happen
unless you provide instructions.</p><p>The input provided to <code class="inline">manage_relationship</code> should be a map, in the case of to_one relationships, or a list of maps
in the case of to_many relationships. The following steps are followed for each input provided:</p><ul><li>The input is checked against the currently related records to find any matches. The primary key and unique identities are used to find matches.</li><li>For any input that had a match in the current relationship, the <code class="inline">:on_match</code> behavior is triggered</li><li>For any input that does not have a match:<ul><li>if there is <code class="inline">on_lookup</code> behavior:<ul><li>we try to find the record in the data layer.</li><li>if the record is found, the on_lookup behavior is triggered</li><li>if the record is not found, the <code class="inline">on_no_match</code> behavior is triggered</li></ul></li><li>if there is no <code class="inline">on_lookup</code> behavior:<ul><li>the <code class="inline">on_no_match</code> behavior is triggered</li></ul></li></ul></li><li>finally, for any records present in the <em>current relationship</em> that had no match <em>in the input</em>, the <code class="inline">on_missing</code> behavior is triggered</li></ul><h2 id="manage_relationship/4-options" class="section-heading">
  <a href="#manage_relationship/4-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><p><code class="inline">:type</code> - If the <code class="inline">type</code> is specified, the default values of each option is modified to match that <code class="inline">type</code> of operation.<br/>This allows for specifying certain operations much more succinctly. The defaults that are modified are listed below:  </p><ul><li><code class="inline">:append_and_remove</code>  <pre><code class="makeup elixir" translate="no"><span class="p" data-group-id="7488498580-1">[</span><span class="w">
  </span><span class="ss">on_lookup</span><span class="p">:</span><span class="w"> </span><span class="ss">:relate</span><span class="p">,</span><span class="w">
  </span><span class="ss">on_no_match</span><span class="p">:</span><span class="w"> </span><span class="ss">:error</span><span class="p">,</span><span class="w">
  </span><span class="ss">on_match</span><span class="p">:</span><span class="w"> </span><span class="ss">:ignore</span><span class="p">,</span><span class="w">
  </span><span class="ss">on_missing</span><span class="p">:</span><span class="w"> </span><span class="ss">:unrelate</span><span class="w">
</span><span class="p" data-group-id="7488498580-1">]</span><span class="w">  </span></code></pre></li><li><code class="inline">:append</code>  <pre><code class="makeup elixir" translate="no"><span class="p" data-group-id="9826082584-1">[</span><span class="w">
  </span><span class="ss">on_lookup</span><span class="p">:</span><span class="w"> </span><span class="ss">:relate</span><span class="p">,</span><span class="w">
  </span><span class="ss">on_no_match</span><span class="p">:</span><span class="w"> </span><span class="ss">:error</span><span class="p">,</span><span class="w">
  </span><span class="ss">on_match</span><span class="p">:</span><span class="w"> </span><span class="ss">:ignore</span><span class="p">,</span><span class="w">
  </span><span class="ss">on_missing</span><span class="p">:</span><span class="w"> </span><span class="ss">:ignore</span><span class="w">
</span><span class="p" data-group-id="9826082584-1">]</span><span class="w">  </span></code></pre></li><li><code class="inline">:remove</code>  <pre><code class="makeup elixir" translate="no"><span class="p" data-group-id="1789763802-1">[</span><span class="w">
  </span><span class="ss">on_no_match</span><span class="p">:</span><span class="w"> </span><span class="ss">:error</span><span class="p">,</span><span class="w">
  </span><span class="ss">on_match</span><span class="p">:</span><span class="w"> </span><span class="ss">:unrelate</span><span class="p">,</span><span class="w">
  </span><span class="ss">on_missing</span><span class="p">:</span><span class="w"> </span><span class="ss">:ignore</span><span class="w">
</span><span class="p" data-group-id="1789763802-1">]</span><span class="w">  </span></code></pre></li><li><code class="inline">:direct_control</code>  <pre><code class="makeup elixir" translate="no"><span class="p" data-group-id="7199318520-1">[</span><span class="w">
  </span><span class="ss">on_lookup</span><span class="p">:</span><span class="w"> </span><span class="ss">:ignore</span><span class="p">,</span><span class="w">
  </span><span class="ss">on_no_match</span><span class="p">:</span><span class="w"> </span><span class="ss">:create</span><span class="p">,</span><span class="w">
  </span><span class="ss">on_match</span><span class="p">:</span><span class="w"> </span><span class="ss">:update</span><span class="p">,</span><span class="w">
  </span><span class="ss">on_missing</span><span class="p">:</span><span class="w"> </span><span class="ss">:destroy</span><span class="w">
</span><span class="p" data-group-id="7199318520-1">]</span><span class="w">  </span></code></pre></li><li><code class="inline">:create</code>  <pre><code class="makeup elixir" translate="no"><span class="p" data-group-id="7548890212-1">[</span><span class="w">
  </span><span class="ss">on_no_match</span><span class="p">:</span><span class="w"> </span><span class="ss">:create</span><span class="p">,</span><span class="w">
  </span><span class="ss">on_match</span><span class="p">:</span><span class="w"> </span><span class="ss">:ignore</span><span class="w">
</span><span class="p" data-group-id="7548890212-1">]</span></code></pre>Valid values are :append_and_remove, :append, :remove, :direct_control, :create</li></ul></li><li><p><code class="inline">:authorize?</code> (<a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types"><code class="inline">boolean/0</code></a>) - Authorize reads and changes to the destination records, if the primary change is being authorized as well. The default value is <code class="inline">true</code>.</p></li><li><p><code class="inline">:eager_validate_with</code> (<a href="https://hexdocs.pm/elixir/typespecs.html#basic-types"><code class="inline">atom/0</code></a>) - Validates that any referenced entities exist <em>before</em> the action is being performed, using the provided domain for the read. The default value is <code class="inline">false</code>.</p></li><li><p><code class="inline">:on_no_match</code> (<a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types"><code class="inline">term/0</code></a>) - Instructions for handling records where no matching record existed in the relationship.  </p><ul><li><code class="inline">:ignore</code> (default) - those inputs are ignored</li><li><code class="inline">:match</code> - For <code class="inline">has_one</code> and <code class="inline">belongs_to</code> only, any input is treated as a match for an existing value. For <code class="inline">has_many</code> and <code class="inline">many_to_many</code>, this is the same as <code class="inline">:ignore</code>.</li><li><code class="inline">:create</code> - the records are created using the destination's primary create action</li><li><code class="inline">{:create, :action_name}</code> - the records are created using the specified action on the destination resource</li><li><code class="inline">{:create, :action_name, :join_table_action_name, [:list, :of, :join_table, :params]}</code> - Same as <code class="inline">{:create, :action_name}</code> but takes
  the list of params specified out and applies them when creating the join record, with the provided join_table_action_name.</li><li><code class="inline">:error</code>  - an error is returned indicating that a record would have been created<ul><li> If <code class="inline">on_lookup</code> is set, and the data contained a primary key or identity, then the error is a <code class="inline">NotFound</code> error</li><li>Otherwise, an <code class="inline">InvalidRelationship</code> error is returned The default value is <code class="inline">:ignore</code>.</li></ul></li></ul></li><li><p><code class="inline">:value_is_key</code> (<a href="https://hexdocs.pm/elixir/typespecs.html#basic-types"><code class="inline">atom/0</code></a>) - Configures what key to use when a single value is provided.<br/>This is useful when you use things like a list of strings i.e <code class="inline">friend_emails</code> to manage the relationship, instead of a list of maps.<br/>By default, we assume it is the primary key of the destination resource, unless it is a composite primary key.</p></li><li><p><code class="inline">:identity_priority</code> (list of <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types"><code class="inline">atom/0</code></a>) - The list, in priority order, of identities to use when looking up records for <code class="inline">on_lookup</code>, and matching records with <code class="inline">on_match</code>.<br/>Use <code class="inline">:_primary_key</code> to prioritize checking a match with the primary key.
All identities, along with <code class="inline">:_primary_key</code> are checked regardless, this only allows ensuring that some are checked first.
Defaults to the list provided by <code class="inline">use_identities</code>, so you typically won't need this option.</p></li><li><p><code class="inline">:use_identities</code> (list of <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types"><code class="inline">atom/0</code></a>) - A list of identities that may be used to look up and compare records. Use <code class="inline">:_primary_key</code> to include the primary key. By default, only <code class="inline">[:_primary_key]</code> is used.</p></li><li><p><code class="inline">:on_lookup</code> (<a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types"><code class="inline">term/0</code></a>) - Before creating a record (because no match was found in the relationship), the record can be looked up and related.  </p><ul><li><code class="inline">:ignore</code> (default) - Does not look for existing entries (matches in the current relationship are still considered updates)</li><li><code class="inline">:relate</code> - Same as calling <code class="inline">{:relate, primary_action_name}</code></li><li><code class="inline">{:relate, :action_name}</code> - the records are looked up by primary key/the first identity that is found (using the primary read action), and related. The action should be:<ul><li><code class="inline">many_to_many</code> - a create action on the join resource</li><li><code class="inline">has_many</code> - an update action on the destination resource</li><li><code class="inline">has_one</code> - an update action on the destination resource</li><li><code class="inline">belongs_to</code> - an update action on the source resource</li></ul></li><li><code class="inline">{:relate, :action_name, :read_action_name}</code> - Same as the above, but customizes the read action called to search for matches.</li><li><code class="inline">:relate_and_update</code> - Same as <code class="inline">:relate</code>, but the remaining parameters from the lookup are passed into the action that is used to change the relationship key</li><li><code class="inline">{:relate_and_update, :action_name}</code> - Same as the above, but customizes the action used. The action should be:<ul><li><code class="inline">many_to_many</code> - a create action on the join resource</li><li><code class="inline">has_many</code> - an update action on the destination resource</li><li><code class="inline">has_one</code> - an update action on the destination resource</li><li><code class="inline">belongs_to</code> - an update action on the source resource</li></ul></li><li><code class="inline">{:relate_and_update, :action_name, :read_action_name}</code> - Same as the above, but customizes the read action called to search for matches.</li><li><code class="inline">{:relate_and_update, :action_name, :read_action_name, [:list, :of, :join_table, :params]}</code> - Same as the above, but uses the provided list of parameters when creating
  the join row (only relevant for many to many relationships). Use <code class="inline">:*</code> to <em>only</em> update the join record, and pass all parameters to its action The default value is <code class="inline">:ignore</code>.</li></ul></li><li><p><code class="inline">:on_match</code> (<a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types"><code class="inline">term/0</code></a>) - Instructions for handling records where a matching record existed in the relationship already.  </p><ul><li><code class="inline">:ignore</code> (default) - those inputs are ignored</li><li><code class="inline">:update</code> - the record is updated using the destination's primary update action</li><li><code class="inline">{:update, :action_name}</code> - the record is updated using the specified action on the destination resource</li><li><code class="inline">{:update, :action_name, :join_table_action_name, [:list, :of, :params]}</code> - Same as <code class="inline">{:update, :action_name}</code> but takes
  the list of params specified out and applies them as an update to the join record (only valid for many to many)</li><li><code class="inline">:update_join</code> - update only the join record (only valid for many to many)</li><li><code class="inline">{:update_join, :join_table_action_name}</code> - use the specified update action on a join resource</li><li><code class="inline">{:update_join, :join_table_action_name, [:list, :of, :params]}</code> - pass specified params from input into a join resource update action</li><li><code class="inline">{:destroy, :action_name}</code> - the record is destroyed using the specified action on the destination resource. The action should be:<ul><li><code class="inline">many_to_many</code> - a destroy action on the join record</li><li><code class="inline">has_many</code> - a destroy action on the destination resource</li><li><code class="inline">has_one</code> - a destroy action on the destination resource</li><li><code class="inline">belongs_to</code> - a destroy action on the destination resource</li></ul></li><li><code class="inline">:error</code>  - an error is returned indicating that a record would have been updated</li><li><code class="inline">:no_match</code> - follows the <code class="inline">on_no_match</code> instructions with these records</li><li><code class="inline">:missing</code> - follows the <code class="inline">on_missing</code> instructions with these records</li><li><code class="inline">:unrelate</code> - the related item is not destroyed, but the data is &quot;unrelated&quot;, making this behave like <code class="inline">remove_from_relationship/3</code>. The action should be:<ul><li><code class="inline">many_to_many</code> - the join resource row is destroyed</li><li><code class="inline">has_many</code> - the <code class="inline">destination_attribute</code> (on the related record) is set to <code class="inline">nil</code></li><li><code class="inline">has_one</code> - the <code class="inline">destination_attribute</code> (on the related record) is set to <code class="inline">nil</code></li><li><code class="inline">belongs_to</code> - the <code class="inline">source_attribute</code> (on this record) is set to <code class="inline">nil</code></li></ul></li><li><code class="inline">{:unrelate, :action_name}</code> - the record is unrelated using the provided update action. The action should be:<ul><li><code class="inline">many_to_many</code> - a destroy action on the join resource</li><li><code class="inline">has_many</code> - an update action on the destination resource</li><li><code class="inline">has_one</code> - an update action on the destination resource</li><li><code class="inline">belongs_to</code> - an update action on the source resource The default value is <code class="inline">:ignore</code>.</li></ul></li></ul></li><li><p><code class="inline">:on_missing</code> (<a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types"><code class="inline">term/0</code></a>) - Instructions for handling records that existed in the current relationship but not in the input.  </p><ul><li><code class="inline">:ignore</code> (default) - those inputs are ignored</li><li><code class="inline">:destroy</code> - the record is destroyed using the destination's primary destroy action</li><li><code class="inline">{:destroy, :action_name}</code> - the record is destroyed using the specified action on the destination resource</li><li><code class="inline">{:destroy, :action_name, :join_resource_action_name}</code> - the record is destroyed using the specified action on the destination resource,
but first the join resource is destroyed with its specified action</li><li><code class="inline">:error</code>  - an error is returned indicating that a record would have been updated</li><li><code class="inline">:unrelate</code> - the related item is not destroyed, but the data is &quot;unrelated&quot;, making this behave like <code class="inline">remove_from_relationship/3</code>. The action should be:<ul><li><code class="inline">many_to_many</code> - the join resource row is destroyed</li><li><code class="inline">has_many</code> - the <code class="inline">destination_attribute</code> (on the related record) is set to <code class="inline">nil</code></li><li><code class="inline">has_one</code> - the <code class="inline">destination_attribute</code> (on the related record) is set to <code class="inline">nil</code></li><li><code class="inline">belongs_to</code> - the <code class="inline">source_attribute</code> (on this record) is set to <code class="inline">nil</code></li></ul></li><li><code class="inline">{:unrelate, :action_name}</code> - the record is unrelated using the provided update action. The action should be:<ul><li><code class="inline">many_to_many</code> - a destroy action on the join resource</li><li><code class="inline">has_many</code> - an update action on the destination resource</li><li><code class="inline">has_one</code> - an update action on the destination resource</li><li><code class="inline">belongs_to</code> - an update action on the source resource The default value is <code class="inline">:ignore</code>.</li></ul></li></ul></li><li><p><code class="inline">:error_path</code> (<a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types"><code class="inline">term/0</code></a>) - By default, errors added to the changeset will use the path <code class="inline">[:relationship_name]</code>, or <code class="inline">[:relationship_name, &lt;index&gt;]</code>.
If you want to modify this path, you can specify <code class="inline">error_path</code>, e.g if had a <code class="inline">change</code> on an action that takes an argument
and uses that argument data to call <code class="inline">manage_relationship</code>, you may want any generated errors to appear under the name of that
argument, so you could specify <code class="inline">error_path: :argument_name</code> when calling <code class="inline">manage_relationship</code>.</p></li><li><p><code class="inline">:join_keys</code> (list of <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types"><code class="inline">atom/0</code></a>) - For many to many relationships specifies the parameters to pick from the input and pass into a join resource action.
Applicable in cases like <code class="inline">on_no_match: :create</code>, <code class="inline">on_match: :update</code> and <code class="inline">on_lookup: :relate</code>.
Can be overwritten by a full form instruction tuple which contains join parameters at the end.</p></li><li><p><code class="inline">:meta</code> (<a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types"><code class="inline">term/0</code></a>) - Freeform data that will be retained along with the options, which can be used to track/manage the changes that are added to the <code class="inline">relationships</code> key.</p></li><li><p><code class="inline">:ignore?</code> (<a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types"><code class="inline">term/0</code></a>) - This tells Ash to ignore the provided inputs when actually running the action. This can be useful for
building up a set of instructions that you intend to handle manually. The default value is <code class="inline">false</code>.</p></li></ul><p>Each call to this function adds new records that will be handled according to their options. For example,
if you tracked &quot;tags to add&quot; and &quot;tags to remove&quot; in separate fields, you could input them like so:</p><pre><code class="makeup elixir" translate="no"><span class="n">changeset</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Ash.Changeset</span><span class="o">.</span><span class="n">manage_relationship</span><span class="p" data-group-id="3652821404-1">(</span><span class="w">
  </span><span class="ss">:tags</span><span class="p">,</span><span class="w">
  </span><span class="p" data-group-id="3652821404-2">[</span><span class="p" data-group-id="3652821404-3">%{</span><span class="ss">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;backend&quot;</span><span class="p" data-group-id="3652821404-3">}</span><span class="p" data-group-id="3652821404-2">]</span><span class="p">,</span><span class="w">
  </span><span class="ss">on_lookup</span><span class="p">:</span><span class="w"> </span><span class="ss">:relate</span><span class="p">,</span><span class="w"> </span><span class="c1">#relate that tag if it exists in the database</span><span class="w">
  </span><span class="ss">on_no_match</span><span class="p">:</span><span class="w"> </span><span class="ss">:error</span><span class="w"> </span><span class="c1"># error if a tag with that name doesn&#39;t exist</span><span class="w">
</span><span class="p" data-group-id="3652821404-1">)</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Ash.Changeset</span><span class="o">.</span><span class="n">manage_relationship</span><span class="p" data-group-id="3652821404-4">(</span><span class="w">
  </span><span class="ss">:tags</span><span class="p">,</span><span class="w">
  </span><span class="p" data-group-id="3652821404-5">[</span><span class="p" data-group-id="3652821404-6">%{</span><span class="ss">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;frontend&quot;</span><span class="p" data-group-id="3652821404-6">}</span><span class="p" data-group-id="3652821404-5">]</span><span class="p">,</span><span class="w">
  </span><span class="ss">on_no_match</span><span class="p">:</span><span class="w"> </span><span class="ss">:error</span><span class="p">,</span><span class="w"> </span><span class="c1"># error if a tag with that name doesn&#39;t exist in the relationship</span><span class="w">
  </span><span class="ss">on_match</span><span class="p">:</span><span class="w"> </span><span class="ss">:unrelate</span><span class="w"> </span><span class="c1"># if a tag with that name is related, unrelate it</span><span class="w">
</span><span class="p" data-group-id="3652821404-4">)</span></code></pre><p>When calling this multiple times with the <code class="inline">on_missing</code> option set, the list of records that are considered missing are checked
after each set of inputs is processed. For example, if you manage the relationship once with <code class="inline">on_missing: :unrelate</code>, the records
missing from your input will be removed, and <em>then</em> your next call to <code class="inline">manage_relationship</code> will be resolved (with those records unrelated).
For this reason, it is suggested that you don't call this function multiple times with an <code class="inline">on_missing</code> instruction, as you may be
surprised by the result.</p><p>If you want the input to update existing entities, you need to ensure that the primary key (or unique identity) is provided as
part of the input. See the example below:</p><pre><code class="makeup elixir" translate="no"><span class="n">changeset</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Ash.Changeset</span><span class="o">.</span><span class="n">manage_relationship</span><span class="p" data-group-id="9033292993-1">(</span><span class="w">
  </span><span class="ss">:comments</span><span class="p">,</span><span class="w">
  </span><span class="p" data-group-id="9033292993-2">[</span><span class="p" data-group-id="9033292993-3">%{</span><span class="ss">rating</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="ss">contents</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;foo&quot;</span><span class="p" data-group-id="9033292993-3">}</span><span class="p" data-group-id="9033292993-2">]</span><span class="p">,</span><span class="w">
  </span><span class="ss">on_no_match</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="9033292993-4">{</span><span class="ss">:create</span><span class="p">,</span><span class="w"> </span><span class="ss">:create_action</span><span class="p" data-group-id="9033292993-4">}</span><span class="p">,</span><span class="w">
  </span><span class="ss">on_missing</span><span class="p">:</span><span class="w"> </span><span class="ss">:ignore</span><span class="w">
</span><span class="p" data-group-id="9033292993-1">)</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Ash.Changeset</span><span class="o">.</span><span class="n">manage_relationship</span><span class="p" data-group-id="9033292993-5">(</span><span class="w">
  </span><span class="ss">:comments</span><span class="p">,</span><span class="w">
  </span><span class="p" data-group-id="9033292993-6">[</span><span class="p" data-group-id="9033292993-7">%{</span><span class="ss">id</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="ss">rating</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="ss">contents</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;foo&quot;</span><span class="p" data-group-id="9033292993-7">}</span><span class="p" data-group-id="9033292993-6">]</span><span class="p">,</span><span class="w">
  </span><span class="ss">on_match</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="9033292993-8">{</span><span class="ss">:update</span><span class="p">,</span><span class="w"> </span><span class="ss">:update_action</span><span class="p" data-group-id="9033292993-8">}</span><span class="p">,</span><span class="w">
  </span><span class="ss">on_no_match</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="9033292993-9">{</span><span class="ss">:create</span><span class="p">,</span><span class="w"> </span><span class="ss">:create_action</span><span class="p" data-group-id="9033292993-9">}</span><span class="p" data-group-id="9033292993-5">)</span></code></pre><p>This is a simple way to manage a relationship. If you need custom behavior, you can customize the action that is
called, which allows you to add arguments/changes. However, at some point you may want to forego this function
and make the changes yourself. For example:</p><pre><code class="makeup elixir" translate="no"><span class="n">input</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="7312449114-1">[</span><span class="p" data-group-id="7312449114-2">%{</span><span class="ss">id</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="ss">rating</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="ss">contents</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;foo&quot;</span><span class="p" data-group-id="7312449114-2">}</span><span class="p" data-group-id="7312449114-1">]</span><span class="w">

</span><span class="n">changeset</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Ash.Changeset</span><span class="o">.</span><span class="n">after_action</span><span class="p" data-group-id="7312449114-3">(</span><span class="k" data-group-id="7312449114-4">fn</span><span class="w"> </span><span class="c">_changeset</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
  </span><span class="c1"># An example of updating comments based on a result of other changes</span><span class="w">
  </span><span class="k">for</span><span class="w"> </span><span class="n">comment</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="k" data-group-id="7312449114-5">do</span><span class="w">
    </span><span class="n">comment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Ash</span><span class="o">.</span><span class="n">get</span><span class="p" data-group-id="7312449114-6">(</span><span class="nc">Comment</span><span class="p">,</span><span class="w"> </span><span class="n">comment</span><span class="o">.</span><span class="n">id</span><span class="p" data-group-id="7312449114-6">)</span><span class="w">

    </span><span class="n">comment</span><span class="w">
    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Map</span><span class="o">.</span><span class="n">update</span><span class="p" data-group-id="7312449114-7">(</span><span class="ss">:rating</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="p" data-group-id="7312449114-8">(</span><span class="ni">&amp;1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">result</span><span class="o">.</span><span class="n">rating_weight</span><span class="p" data-group-id="7312449114-8">)</span><span class="p" data-group-id="7312449114-7">)</span><span class="w">
    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Ash</span><span class="o">.</span><span class="n">update!</span><span class="p" data-group-id="7312449114-9">(</span><span class="p" data-group-id="7312449114-9">)</span><span class="w">
  </span><span class="k" data-group-id="7312449114-5">end</span><span class="w">

  </span><span class="p" data-group-id="7312449114-10">{</span><span class="ss">:ok</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p" data-group-id="7312449114-10">}</span><span class="w">
</span><span class="k" data-group-id="7312449114-4">end</span><span class="p" data-group-id="7312449114-3">)</span></code></pre><h2 id="manage_relationship/4-using-records-as-input" class="section-heading">
  <a href="#manage_relationship/4-using-records-as-input" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Using records as input</span>
</h2>
<p>Records can be supplied as the input values. If you do:</p><ul><li>if it would be looked up due to <code class="inline">on_lookup</code>, the record is used as-is</li><li>if it would be created due to <code class="inline">on_no_match</code>, the record is used as-is</li><li>Instead of specifying <code class="inline">join_keys</code>, those keys must go in <code class="inline">__metadata__.join_keys</code>. If <code class="inline">join_keys</code> is specified in the options, it is ignored.</li></ul><p>For example:</p><pre><code class="makeup elixir" translate="no"><span class="n">post1</span><span class="w"> </span><span class="o">=</span><span class="w">
  </span><span class="n">changeset</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Ash</span><span class="o">.</span><span class="n">create!</span><span class="p" data-group-id="9509874816-1">(</span><span class="p" data-group-id="9509874816-1">)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Ash.Resource</span><span class="o">.</span><span class="n">put_metadata</span><span class="p" data-group-id="9509874816-2">(</span><span class="ss">:join_keys</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9509874816-3">%{</span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;a&quot;</span><span class="p" data-group-id="9509874816-3">}</span><span class="p" data-group-id="9509874816-2">)</span><span class="w">

</span><span class="n">post1</span><span class="w"> </span><span class="o">=</span><span class="w">
  </span><span class="n">changeset2</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Ash</span><span class="o">.</span><span class="n">create!</span><span class="p" data-group-id="9509874816-4">(</span><span class="p" data-group-id="9509874816-4">)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Ash.Resource</span><span class="o">.</span><span class="n">put_metadata</span><span class="p" data-group-id="9509874816-5">(</span><span class="ss">:join_keys</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9509874816-6">%{</span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;b&quot;</span><span class="p" data-group-id="9509874816-6">}</span><span class="p" data-group-id="9509874816-5">)</span><span class="w">

</span><span class="n">author</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Ash</span><span class="o">.</span><span class="n">create!</span><span class="p" data-group-id="9509874816-7">(</span><span class="n">author_changeset</span><span class="p" data-group-id="9509874816-7">)</span><span class="w">

</span><span class="nc">Ash.Changeset</span><span class="o">.</span><span class="n">manage_relationship</span><span class="p" data-group-id="9509874816-8">(</span><span class="w">
  </span><span class="n">author</span><span class="p">,</span><span class="w">
  </span><span class="ss">:posts</span><span class="p">,</span><span class="w">
  </span><span class="p" data-group-id="9509874816-9">[</span><span class="n">post1</span><span class="p">,</span><span class="w"> </span><span class="n">post2</span><span class="p" data-group-id="9509874816-9">]</span><span class="p">,</span><span class="w">
  </span><span class="ss">on_lookup</span><span class="p">:</span><span class="w"> </span><span class="ss">:relate</span><span class="w">
</span><span class="p" data-group-id="9509874816-8">)</span></code></pre>
  </section>
</section>
<section class="detail" id="manage_relationship_opts/1">

  <div class="detail-header">
    <a href="#manage_relationship_opts/1" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">manage_relationship_opts(atom)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L3916" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> manage_relationship_opts(<a href="#t:manage_relationship_type/0">manage_relationship_type</a>()) :: <a href="https://hexdocs.pm/elixir/Keyword.html#t:t/0">Keyword.t</a>()</pre>

      </div>


  </section>
</section>
<section class="detail" id="new/1">

  <div class="detail-header">
    <a href="#new/1" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">new(record_or_resource)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L388" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> new(<a href="Ash.Resource.html#t:t/0">Ash.Resource.t</a>() | <a href="Ash.Resource.html#t:record/0">Ash.Resource.record</a>()) :: <a href="#t:t/0">t</a>()</pre>

      </div>

<p>Returns a new changeset over a resource.</p><p><em>Warning</em>: You almost always want to use <code class="inline">for_action</code> or <code class="inline">for_create</code>, etc. over this function if possible.</p><p>You can use this to start a changeset and make changes prior to calling <code class="inline">for_action</code>. This is not typically
necessary, but can be useful as an escape hatch. For example:</p><pre><code class="makeup elixir" translate="no"><span class="nc">Resource</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Ash.Changeset</span><span class="o">.</span><span class="n">new</span><span class="p" data-group-id="4492634996-1">(</span><span class="p" data-group-id="4492634996-1">)</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Ash.Changeset</span><span class="o">.</span><span class="n">change_attribute</span><span class="p" data-group-id="4492634996-2">(</span><span class="ss">:name</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;foobar&quot;</span><span class="p" data-group-id="4492634996-2">)</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Ash.Changeset</span><span class="o">.</span><span class="n">for_action</span><span class="p" data-group-id="4492634996-3">(</span><span class="n">...</span><span class="p" data-group-id="4492634996-3">)</span></code></pre>
  </section>
</section>
<section class="detail" id="prepare_changeset_for_action/3">

  <div class="detail-header">
    <a href="#prepare_changeset_for_action/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">prepare_changeset_for_action(changeset, action, opts)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L1834" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">


  </section>
</section>
<section class="detail" id="present?/2">

  <div class="detail-header">
    <a href="#present?/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">present?(changeset, attribute)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L1778" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Checks if an argument is not nil or an attribute is not nil, either in the original data, or that it is not being changed to a <code class="inline">nil</code> value if it is changing.</p><p>This also accounts for the <code class="inline">accessing_from</code> context that is set when using <code class="inline">manage_relationship</code>, so it is aware that a particular value
<em>will</em> be set by <code class="inline">manage_relationship</code> even if it isn't currently being set.</p>
  </section>
</section>
<section class="detail" id="put_context/3">

  <div class="detail-header">
    <a href="#put_context/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">put_context(changeset, key, value)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L3879" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> put_context(<a href="#t:t/0">t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>()) :: <a href="#t:t/0">t</a>()</pre>

      </div>

<p>Puts a key/value in the changeset context that can be used later.</p><p>Do not use the <code class="inline">private</code> key in your custom context, as that is reserved for internal use.</p>
  </section>
</section>
<section class="detail" id="run_atomic_change/3">

  <div class="detail-header">
    <a href="#run_atomic_change/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">run_atomic_change(changeset, map, context)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L849" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">


  </section>
</section>
<section class="detail" id="run_before_transaction_hooks/1">

  <div class="detail-header">
    <a href="#run_before_transaction_hooks/1" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">run_before_transaction_hooks(changeset)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L3449" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">


  </section>
</section>
<section class="detail" id="select/3">

    <span id="select/2"></span>

  <div class="detail-header">
    <a href="#select/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">select(changeset, fields, opts \\ [])</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L439" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Ensure that only the specified attributes are present in the results.</p><p>The first call to <a href="#select/2"><code class="inline">select/2</code></a> will replace the default behavior of selecting
all attributes. Subsequent calls to <a href="#select/2"><code class="inline">select/2</code></a> will combine the provided
fields unless the <code class="inline">replace?</code> option is provided with a value of <code class="inline">true</code>.</p><p>If a field has been deselected, selecting it again will override that (because a single list of fields is tracked for selection)</p><p>Primary key attributes always selected and cannot be deselected.</p><p>When attempting to load a relationship (or manage it with <a href="#manage_relationship/3"><code class="inline">Ash.Changeset.manage_relationship/3</code></a>),
if the source field is not selected on the query/provided data an error will be produced. If loading
a relationship with a query, an error is produced if the query does not select the destination field
of the relationship.</p><p>Datalayers currently are not notified of the <code class="inline">select</code> for a changeset(unlike queries), and creates/updates select all fields when they are performed.
A select provided on a changeset sets the unselected fields to <code class="inline">nil</code> before returning the result.</p><p>Use <a href="#ensure_selected/2"><code class="inline">ensure_selected/2</code></a> if you wish to make sure a field has been selected, without deselecting any other fields.</p>
  </section>
</section>
<section class="detail" id="selecting?/2">

  <div class="detail-header">
    <a href="#selecting?/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">selecting?(changeset, field)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L506" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">


  </section>
</section>
<section class="detail" id="set_argument/3">

  <div class="detail-header">
    <a href="#set_argument/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">set_argument(changeset, argument, value)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L4772" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Add an argument to the changeset, which will be provided to the action.</p>
  </section>
</section>
<section class="detail" id="set_arguments/2">

  <div class="detail-header">
    <a href="#set_arguments/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">set_arguments(changeset, map)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L4854" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Merge a map of arguments to the arguments list.</p>
  </section>
</section>
<section class="detail" id="set_context/2">

  <div class="detail-header">
    <a href="#set_context/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">set_context(changeset, map)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L3899" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> set_context(<a href="#t:t/0">t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">map</a>() | nil) :: <a href="#t:t/0">t</a>()</pre>

      </div>

<p>Deep merges the provided map into the changeset context that can be used later.</p><p>Do not use the <code class="inline">private</code> key in your custom context, as that is reserved for internal use.</p>
  </section>
</section>
<section class="detail" id="set_on_upsert/2">

  <div class="detail-header">
    <a href="#set_on_upsert/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">set_on_upsert(changeset, upsert_keys)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L1626" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> set_on_upsert(<a href="#t:t/0">t</a>(), [<a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>()]) :: <a href="https://hexdocs.pm/elixir/Keyword.html#t:t/0">Keyword.t</a>()</pre>

      </div>


  </section>
</section>
<section class="detail" id="set_result/2">

  <div class="detail-header">
    <a href="#set_result/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">set_result(changeset, result)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L1598" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> set_result(<a href="#t:t/0">t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>()) :: <a href="#t:t/0">t</a>()</pre>

      </div>

<p>Set the result of the action. This will prevent running the underlying datalayer behavior</p>
  </section>
</section>
<section class="detail" id="set_tenant/2">

  <div class="detail-header">
    <a href="#set_tenant/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">set_tenant(changeset, tenant)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L3884" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> set_tenant(<a href="#t:t/0">t</a>(), <a href="Ash.ToTenant.html#t:t/0">Ash.ToTenant.t</a>()) :: <a href="#t:t/0">t</a>()</pre>

      </div>


  </section>
</section>
<section class="detail" id="timeout/3">

    <span id="timeout/2"></span>

  <div class="detail-header">
    <a href="#timeout/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">timeout(changeset, timeout, default \\ nil)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L3889" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> timeout(<a href="#t:t/0">t</a>(), nil | <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">pos_integer</a>(), nil | <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">pos_integer</a>()) :: <a href="#t:t/0">t</a>()</pre>

      </div>


  </section>
</section>
<section class="detail" id="update_change/3">

  <div class="detail-header">
    <a href="#update_change/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">update_change(changeset, attribute, fun)</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L4759" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> update_change(<a href="#t:t/0">t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>(), (<a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">any</a>() -&gt; <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">any</a>())) :: <a href="#t:t/0">t</a>()</pre>

      </div>

<p>Updates an existing attribute change by applying a function to it.</p><p>This is useful for applying some kind of normalization to the attribute.</p><pre><code class="makeup elixir" translate="no"><span class="nc">Ash.Changeset</span><span class="o">.</span><span class="n">update_change</span><span class="p" data-group-id="1568520575-1">(</span><span class="n">changeset</span><span class="p">,</span><span class="w"> </span><span class="ss">:serial</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="nc">String</span><span class="o">.</span><span class="n">downcase</span><span class="o">/</span><span class="mi">1</span><span class="p" data-group-id="1568520575-1">)</span></code></pre><p>The update function gets called with the value already cast to the correct type.</p><pre><code class="makeup elixir" translate="no"><span class="n">changeset</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Ash.Changeset</span><span class="o">.</span><span class="n">change_attribute</span><span class="p" data-group-id="7729812863-1">(</span><span class="ss">:integer_attribute</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;3&quot;</span><span class="p" data-group-id="7729812863-1">)</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Ash.Changeset</span><span class="o">.</span><span class="n">update_change</span><span class="p" data-group-id="7729812863-2">(</span><span class="ss">:integer_attribute</span><span class="p">,</span><span class="w"> </span><span class="k" data-group-id="7729812863-3">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k" data-group-id="7729812863-3">end</span><span class="p" data-group-id="7729812863-2">)</span></code></pre><h2 id="update_change/3-invalid-value-handling" class="section-heading">
  <a href="#update_change/3-invalid-value-handling" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Invalid value handling</span>
</h2>
<p>If <code class="inline">update_change</code> is called with a changeset that has not been validated yet, the update
function must handle potentially invalid and <code class="inline">nil</code> values.</p><p>To only deal with valid values, you can call <code class="inline">update_change</code> in a <code class="inline">before_action</code> hook.</p>
  </section>
</section>
<section class="detail" id="with_hooks/3">

    <span id="with_hooks/2"></span>

  <div class="detail-header">
    <a href="#with_hooks/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">with_hooks(changeset, func, opts \\ [])</h1>

      <a href="https://github.com/ash-project/ash/blob/v3.4.8/lib/ash/changeset/changeset.ex#L3168" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> with_hooks(
  <a href="#t:t/0">t</a>(),
  (<a href="#t:t/0">t</a>() -&gt;
     {:ok, <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>(), %{notifications: [<a href="Ash.Notifier.Notification.html#t:t/0">Ash.Notifier.Notification.t</a>()]}}
     | {:error, <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>()}),
  <a href="https://hexdocs.pm/elixir/Keyword.html#t:t/0">Keyword.t</a>()
) ::
  {:ok, <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>(), <a href="#t:t/0">t</a>(), %{notifications: [<a href="Ash.Notifier.Notification.html#t:t/0">Ash.Notifier.Notification.t</a>()]}}
  | {:error, <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>()}</pre>

      </div>

<p>Wraps a function in the before/after action hooks of a changeset.</p><p>The function takes a changeset and if it returns
<code class="inline">{:ok, result}</code>, the result will be passed through the after
action hooks.</p>
  </section>
</section>

    </div>
  </section>

    <footer class="footer">
      <p>

          <span class="line">
            <a href="https://hex.pm/packages/ash/3.4.8" class="footer-hex-package">Hex Package</a>

            <a href="https://preview.hex.pm/preview/ash/3.4.8">Hex Preview</a>

          </span>

        <span class="line">
          <button class="a-main footer-button display-quick-switch" title="Search HexDocs packages">
            Search HexDocs
          </button>

            <a href="ash.epub" title="ePub version">
              Download ePub version
            </a>

        </span>
      </p>

      <p class="built-using">
        Built using
        <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.34.2) for the

          <a href="https://elixir-lang.org" title="Elixir" target="_blank" translate="no">Elixir programming language</a>

      </p>

    </footer>
  </div>
</main>
</div>

  </body>
</html>
