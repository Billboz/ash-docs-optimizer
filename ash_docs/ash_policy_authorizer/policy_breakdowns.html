<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.25.2">
    <meta name="project" content="ash_policy_authorizer v0.16.5">

    <title>Policy Breakdowns ‚Äî ash_policy_authorizer v0.16.5</title>
    <link rel="stylesheet" href="dist/elixir-37545fd2f35b96531434.css" />

    <script src="dist/sidebar_items-8be34f4263.js"></script>

      <script src="docs_config.js"></script>

    <script async src="dist/app-f97730d45ef67f3e6188.js"></script>


  </head>
  <body data-type="extras">
    <script>

      try {
        if (localStorage.getItem('night-mode') === 'true') {
          document.body.classList.add('night-mode');
        }
      } catch (error) { }
    </script>

<div class="main">

<button class="sidebar-button sidebar-toggle">
  <span class="icon-menu" title="Collapse/expand sidebar"></span>
</button>

<section class="sidebar">
  <form class="sidebar-search" action="search.html">
    <button type="submit" class="search-button" aria-label="Submit Search">
      <span class="icon-search" aria-hidden="true" title="Submit search"></span>
    </button>
    <button type="button" tabindex="-1" class="search-close-button" aria-label="Cancel Search">
      <span class="icon-cross" aria-hidden="true" title="Cancel search"></span>
    </button>
    <label class="search-label">
      <input name="q" type="text" class="search-input" placeholder="Search..." aria-label="Input your search terms" autocomplete="off" />
    </label>
  </form>

  <div class="autocomplete">
    <div class="autocomplete-results">
    </div>
  </div>

  <div class="sidebar-header">
    <div class="sidebar-projectDetails">
      <a href="https://github.com/ash-project/ash_policy_authorizer" class="sidebar-projectName">
ash_policy_authorizer
      </a>
      <strong class="sidebar-projectVersion">
        v0.16.5
      </strong>
    </div>

      <a href="https://github.com/ash-project/ash_policy_authorizer">
        <img src="assets/logo.png" alt="ash_policy_authorizer" class="sidebar-projectImage">
      </a>

  </div>

  <ul class="sidebar-listNav">
    <li><a id="extras-list-link" href="#full-list">GUIDES</a></li>

      <li><a id="modules-list-link" href="#full-list">Modules</a></li>


  </ul>
  <div class="gradient"></div>
  <ul id="full-list" class="sidebar-fullList"></ul>
</section>

<section class="content">
  <div class="content-outer">
    <div id="content" class="content-inner">

<h1>Policy Breakdowns</h1><h2 id="explanation" class="section-heading">
  <a href="#explanation" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Explanation
</h2>
<p>Policy breakdowns can be fetched on demand for a given forbidden error (either an <a href="https://hexdocs.pm/ash/1.50.14/Ash.Error.Forbidden.html"><code class="inline">Ash.Error.Forbidden</code></a> that contains one ore more <a href="AshPolicyAuthorizer.Forbidden.html"><code class="inline">AshPolicyAuthorizer.Forbidden</code></a>
errors, or an <a href="AshPolicyAuthorizer.Forbidden.html"><code class="inline">AshPolicyAuthorizer.Forbidden</code></a> error itself), via <a href="AshPolicyAuthorizer.Forbidden.html#report/2"><code class="inline">AshPolicyAuthorizer.Forbidden.report/2</code></a>.</p><p>Here is an example policy breakdown from ash_policy_authorizer tests:</p><pre><code class="text">Policy Breakdown
A check status of `?` implies that the solver did not need to determine that check.
Some checks may look like they failed when in reality there was simply no need to check them.
Look for policies with `‚úò` and `‚úì` in check statuses.

A check with a `‚¨á` means that it didn't determine if the policy was authorized or forbidden, and so moved on to the next check.
`üåü` and `‚õî` mean that the check was responsible for producing an authorized or forbidden (respectively) status.

If no check results in a status (they all have `‚¨á`) then the policy is assumed to have failed. In some cases, however, the policy
may have just been ignored, as described above.

  Admins and managers can create posts | ‚õî:
    authorize if: actor.admin == true | ‚úò | ‚¨á    
    authorize if: actor.manager == true | ‚úò | ‚¨á</code></pre><p>To remove the help text, you can pass the <code class="inline">help_text?: false</code> option, which would leave you with:</p><pre><code class="text">Policy Breakdown
  Admins and managers can create posts | ‚õî:
    authorize if: actor.admin == true | ‚úò | ‚¨á    
    authorize if: actor.manager == true | ‚úò | ‚¨á</code></pre><h2 id="including-in-error-message" class="section-heading">
  <a href="#including-in-error-message" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Including in error message
</h2>
<h3 id="important-warning" class="section-heading">
  <a href="#important-warning" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  <strong>IMPORTANT WARNING</strong>
</h3>
<p>The following configuration should only ever be used in development mode!</p><h3 id="instructions" class="section-heading">
  <a href="#instructions" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Instructions
</h3>
<p>For security reasons, authorization errors don't include any extra information, aside from <code class="inline">forbidden</code>. To have authorization errors include a policy breakdown (without help text)
use the following config.</p><pre><code class="makeup elixir"><span class="n">config</span><span class="w"> </span><span class="ss">:ash_policy_authorizer</span><span class="p">,</span><span class="w"> </span><span class="ss">show_policy_breakdowns?</span><span class="p">:</span><span class="w"> </span><span class="no">true</span></code></pre><h2 id="logging" class="section-heading">
  <a href="#logging" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Logging
</h2>
<p>It is generally safe to log authorization error details, even in production. This can be very helpful when investigating certain classes of issue.</p><p>To have ash_policy_authorizer automatically log each authorization failure, use</p><pre><code class="makeup elixir"><span class="n">config</span><span class="w"> </span><span class="ss">:ash_policy_authorizer</span><span class="p">,</span><span class="w"> </span><span class="ss">log_policy_breakdowns</span><span class="p">:</span><span class="w"> </span><span class="ss">:error</span><span class="w"> </span><span class="c1"># Use whatever log level you&#39;d like to use here</span></code></pre>
<div class="bottom-actions">
  <div class="bottom-actions-item">

      <a href="writing_policies.html" class="bottom-actions-button" rel="prev">
        <span class="subheader">
          ‚Üê Previous Page
        </span>
        <span class="title">
Writing Policies
        </span>
      </a>

  </div>
  <div class="bottom-actions-item">

  </div>
</div>

      <footer class="footer">

        <p>
          Find it on Hex:
          <a href="https://hex.pm/packages/ash_policy_authorizer/0.16.5" class="line footer-hex-package">Package</a>
          <a href="https://preview.hex.pm/preview/ash_policy_authorizer/0.16.5" class="line">Preview</a>

            <a href="https://preview.hex.pm/preview/ash_policy_authorizer/0.16.5/show/documentation/policy_breakdowns.md">(current file)</a>

        </p>

        <p>
          <span class="line">
            Built using
            <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener">ExDoc</a> (v0.25.2) for the
            <a href="https://elixir-lang.org" title="Elixir" target="_blank">Elixir programming language</a>.
          </span>
          <span class="line">
            Designed by
            <a href="https://twitter.com/dignifiedquire" target="_blank" rel="noopener" title="@dignifiedquire">Friedel Ziegelmayer</a>.
          </span>
        </p>
        <p>

            <a href="api-reference.html" title="API reference" class="line footer-button">API Reference</a>

          <button class="line footer-button display-shortcuts-help">
            Display keyboard shortcuts
          </button>
          <button class="line footer-button night-mode-toggle">
            Toggle night mode
          </button>
          <button class="line footer-button display-quick-switch">
            Go to a HexDocs package
          </button>
          <button class="line footer-button tooltips-toggle">
            <span class="tooltips-option-disable">Disable tooltips</span>
            <span class="tooltips-option-enable">Enable tooltips</span>
          </button>
        </p>
      </footer>
    </div>
  </div>
</section>
</div>


  </body>
</html>
