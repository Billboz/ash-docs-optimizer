<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.25.2">
    <meta name="project" content="ash_policy_authorizer v0.16.5">

    <title>AshPolicyAuthorizer.Authorizer â€” ash_policy_authorizer v0.16.5</title>
    <link rel="stylesheet" href="dist/elixir-37545fd2f35b96531434.css" />

    <script src="dist/sidebar_items-8be34f4263.js"></script>

      <script src="docs_config.js"></script>

    <script async src="dist/app-f97730d45ef67f3e6188.js"></script>


  </head>
  <body data-type="modules">
    <script>

      try {
        if (localStorage.getItem('night-mode') === 'true') {
          document.body.classList.add('night-mode');
        }
      } catch (error) { }
    </script>

<div class="main">

<button class="sidebar-button sidebar-toggle">
  <span class="icon-menu" title="Collapse/expand sidebar"></span>
</button>

<section class="sidebar">
  <form class="sidebar-search" action="search.html">
    <button type="submit" class="search-button" aria-label="Submit Search">
      <span class="icon-search" aria-hidden="true" title="Submit search"></span>
    </button>
    <button type="button" tabindex="-1" class="search-close-button" aria-label="Cancel Search">
      <span class="icon-cross" aria-hidden="true" title="Cancel search"></span>
    </button>
    <label class="search-label">
      <input name="q" type="text" class="search-input" placeholder="Search..." aria-label="Input your search terms" autocomplete="off" />
    </label>
  </form>

  <div class="autocomplete">
    <div class="autocomplete-results">
    </div>
  </div>

  <div class="sidebar-header">
    <div class="sidebar-projectDetails">
      <a href="https://github.com/ash-project/ash_policy_authorizer" class="sidebar-projectName">
ash_policy_authorizer
      </a>
      <strong class="sidebar-projectVersion">
        v0.16.5
      </strong>
    </div>

      <a href="https://github.com/ash-project/ash_policy_authorizer">
        <img src="assets/logo.png" alt="ash_policy_authorizer" class="sidebar-projectImage">
      </a>

  </div>

  <ul class="sidebar-listNav">
    <li><a id="extras-list-link" href="#full-list">GUIDES</a></li>

      <li><a id="modules-list-link" href="#full-list">Modules</a></li>


  </ul>
  <div class="gradient"></div>
  <ul id="full-list" class="sidebar-fullList"></ul>
</section>

<section class="content">
  <div class="content-outer">
    <div id="content" class="content-inner">

      <h1>
AshPolicyAuthorizer.Authorizer <small class="app-vsn">(ash_policy_authorizer v0.16.5)</small>

          <a href="https://github.com/ash-project/ash_policy_authorizer/blob/v0.16.5/lib/ash_policy_authorizer/authorizer.ex#L1" title="View Source" class="view-source" rel="help">
            <span class="icon-code" aria-hidden="true"></span>
            <span class="sr-only">View Source</span>
          </a>

      </h1>


        <section id="moduledoc">
<p>An authorization extension for ash resources.</p><p>To add this extension to a resource, add it to the list of <code class="inline">authorizers</code> like so:</p><pre><code class="makeup elixir"><span class="kn">use</span><span class="w"> </span><span class="nc">Ash.Resource</span><span class="p">,</span><span class="w">
  </span><span class="n">...</span><span class="p">,</span><span class="w">
  </span><span class="ss">authorizers</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="4343202196-1">[</span><span class="w">
    </span><span class="nc">AshPolicyAuthorizer.Authorizer</span><span class="w">
  </span><span class="p" data-group-id="4343202196-1">]</span></code></pre><h1>DSL Documenation</h1><h2 id="module-table-of-contents" class="section-heading">
  <a href="#module-table-of-contents" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Table of Contents
</h2>
<ul><li><a href="#module-policies">policies</a><ul><li>policy<ul><li>authorize_if</li><li>forbid_if</li><li>authorize_unless</li><li>forbid_unless</li></ul></li><li>bypass<ul><li>authorize_if</li><li>forbid_if</li><li>authorize_unless</li><li>forbid_unless</li></ul></li></ul></li></ul><h2 id="module-policies" class="section-heading">
  <a href="#module-policies" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  policies
</h2>
<p>A section for declaring authorization policies.</p><p>Each policy that applies must pass independently in order for the
request to be authorized.</p><ul><li><a href="#module-policy">policy</a><ul><li>authorize_if</li><li>forbid_if</li><li>authorize_unless</li><li>forbid_unless</li></ul></li><li><a href="#module-bypass">bypass</a><ul><li>authorize_if</li><li>forbid_if</li><li>authorize_unless</li><li>forbid_unless</li></ul></li></ul><p>Examples:</p><pre><code class="makeup elixir"><span class="n">policies</span><span class="w"> </span><span class="k" data-group-id="0569112635-1">do</span><span class="w">
  </span><span class="c1"># Anything you can use in a condition, you can use in a check, and vice-versa</span><span class="w">
  </span><span class="c1"># This policy applies if the actor is a super_user</span><span class="w">
  </span><span class="c1"># Addtionally, this policy is declared as a `bypass`. That means that this check is allowed to fail without</span><span class="w">
  </span><span class="c1"># failing the whole request, and that if this check *passes*, the entire request passes.</span><span class="w">
  </span><span class="n">bypass</span><span class="w"> </span><span class="n">actor_attribute_equals</span><span class="p" data-group-id="0569112635-2">(</span><span class="ss">:super_user</span><span class="p">,</span><span class="w"> </span><span class="no">true</span><span class="p" data-group-id="0569112635-2">)</span><span class="w"> </span><span class="k" data-group-id="0569112635-3">do</span><span class="w">
    </span><span class="n">authorize_if</span><span class="w"> </span><span class="n">always</span><span class="p" data-group-id="0569112635-4">(</span><span class="p" data-group-id="0569112635-4">)</span><span class="w">
  </span><span class="k" data-group-id="0569112635-3">end</span><span class="w">

  </span><span class="c1"># This will likely be a common occurrence. Specifically, policies that apply to all read actions</span><span class="w">
  </span><span class="n">policy</span><span class="w"> </span><span class="n">action_type</span><span class="p" data-group-id="0569112635-5">(</span><span class="ss">:read</span><span class="p" data-group-id="0569112635-5">)</span><span class="w"> </span><span class="k" data-group-id="0569112635-6">do</span><span class="w">
    </span><span class="c1"># unless the actor is an active user, forbid their request</span><span class="w">
    </span><span class="n">forbid_unless</span><span class="w"> </span><span class="n">actor_attribute_equals</span><span class="p" data-group-id="0569112635-7">(</span><span class="ss">:active</span><span class="p">,</span><span class="w"> </span><span class="no">true</span><span class="p" data-group-id="0569112635-7">)</span><span class="w">
    </span><span class="c1"># if the record is marked as public, authorize the request</span><span class="w">
    </span><span class="n">authorize_if</span><span class="w"> </span><span class="n">attribute</span><span class="p" data-group-id="0569112635-8">(</span><span class="ss">:public</span><span class="p">,</span><span class="w"> </span><span class="no">true</span><span class="p" data-group-id="0569112635-8">)</span><span class="w">
    </span><span class="c1"># if the actor is related to the data via that data&#39;s `owner` relationship, authorize the request</span><span class="w">
    </span><span class="n">authorize_if</span><span class="w"> </span><span class="n">relates_to_actor_via</span><span class="p" data-group-id="0569112635-9">(</span><span class="ss">:owner</span><span class="p" data-group-id="0569112635-9">)</span><span class="w">
  </span><span class="k" data-group-id="0569112635-6">end</span><span class="w">
</span><span class="k" data-group-id="0569112635-1">end</span><span class="w">
</span></code></pre><p>Imports:</p><ul><li><a href="AshPolicyAuthorizer.Check.BuiltInChecks.html"><code class="inline">AshPolicyAuthorizer.Check.BuiltInChecks</code></a></li><li><a href="https://hexdocs.pm/ash/1.50.14/Ash.Filter.TemplateHelpers.html"><code class="inline">Ash.Filter.TemplateHelpers</code></a></li></ul><hr class="thin"/><ul><li><code class="inline">:default_access_type</code> - The default access type of policies for this resource.<br/>See the access type on individual policies for more information. The default value is <code class="inline">:filter</code>.</li></ul><h3 id="module-policy" class="section-heading">
  <a href="#module-policy" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  policy
</h3>
<p>A policy has a name, a condition, and a list of checks.</p><p>Checks apply logically in the order they are specified, from top to bottom.
If no check explicitly authorizes the request, then the request is forbidden.
This means that, if you want to &quot;blacklist&quot; instead of &quot;whitelist&quot;, you likely
want to add an <code class="inline">authorize_if always()</code> at the bottom of your policy, like so:</p><pre><code class="makeup elixir"><span class="n">policy</span><span class="w"> </span><span class="n">action_type</span><span class="p" data-group-id="0439694779-1">(</span><span class="ss">:read</span><span class="p" data-group-id="0439694779-1">)</span><span class="w"> </span><span class="k" data-group-id="0439694779-2">do</span><span class="w">
  </span><span class="n">forbid_if</span><span class="w"> </span><span class="n">not_logged_in</span><span class="p" data-group-id="0439694779-3">(</span><span class="p" data-group-id="0439694779-3">)</span><span class="w">
  </span><span class="n">forbid_if</span><span class="w"> </span><span class="n">user_is_denylisted</span><span class="p" data-group-id="0439694779-4">(</span><span class="p" data-group-id="0439694779-4">)</span><span class="w">
  </span><span class="n">forbid_if</span><span class="w"> </span><span class="n">user_is_in_denylisted_group</span><span class="p" data-group-id="0439694779-5">(</span><span class="p" data-group-id="0439694779-5">)</span><span class="w">

  </span><span class="n">authorize_if</span><span class="w"> </span><span class="n">always</span><span class="p" data-group-id="0439694779-6">(</span><span class="p" data-group-id="0439694779-6">)</span><span class="w">
</span><span class="k" data-group-id="0439694779-2">end</span></code></pre><p>If the policy should always run, use the <code class="inline">always()</code> check, like so:</p><pre><code class="makeup elixir"><span class="n">policy</span><span class="w"> </span><span class="n">always</span><span class="p" data-group-id="6003572866-1">(</span><span class="p" data-group-id="6003572866-1">)</span><span class="w"> </span><span class="k" data-group-id="6003572866-2">do</span><span class="w">
  </span><span class="n">...</span><span class="w">
</span><span class="k" data-group-id="6003572866-2">end</span></code></pre><ul><li><a href="#module-authorize_if">authorize_if</a></li><li><a href="#module-forbid_if">forbid_if</a></li><li><a href="#module-authorize_unless">authorize_unless</a></li><li><a href="#module-forbid_unless">forbid_unless</a></li></ul><p>Introspection Target:</p><p><code class="inline">AshPolicyAuthorizer.Policy</code></p><ul><li><p><code class="inline">:description</code> - A description for the policy, used when explaining authorization results</p></li><li><p><code class="inline">:access_type</code> - There are three choices for access_type:  </p></li><li><p><code class="inline">:strict</code> - authentication uses <em>only</em> the request context, failing when unknown.</p></li><li><p><code class="inline">:filter</code> - this is probably what you want. Automatically removes unauthorized data by altering the request filter.</p></li><li><p><code class="inline">:runtime</code> - tries to add a filter before the query, but if it cannot, it fetches the records and checks authorization.<br/>Be careful with runtime checks, as they can potentially cause a given scenario to fetch <em>all</em> records of a resource, because
it can't figure out a common filter between all of the possible scenarios. Use sparingly, if at all.</p><ul><li><code class="inline">:condition</code> - A check or list of checks that must be true in order for this policy to apply.  </li></ul></li></ul><p>If the policy does not apply, it is not run, and some other policy
will need to authorize the request. If no policies apply, the request
is forbidden. If multiple policies apply, they must each authorize the
request.</p><h5>authorize_if</h5><p>If the check is true, the request is authorized, otherwise run remaining checks.</p><p>Introspection Target:</p><p><code class="inline">AshPolicyAuthorizer.Policy.Check</code></p><p>Examples:</p><pre><code class="makeup elixir"><span class="n">authorize_if</span><span class="w"> </span><span class="n">logged_in</span><span class="p" data-group-id="6511925891-1">(</span><span class="p" data-group-id="6511925891-1">)</span></code></pre><pre><code class="makeup elixir"><span class="n">authorize_if</span><span class="w"> </span><span class="n">actor_attribute_matches_record</span><span class="p" data-group-id="0990480577-1">(</span><span class="ss">:group</span><span class="p">,</span><span class="w"> </span><span class="ss">:group</span><span class="p" data-group-id="0990480577-1">)</span></code></pre><ul><li><p><code class="inline">:check</code> - Required. A check is a tuple of <code class="inline">{module, keyword}</code>.<br/>The module must implement the <a href="AshPolicyAuthorizer.Check.html"><code class="inline">AshPolicyAuthorizer.Check</code></a> behaviour.
Generally, you won't be passing <code class="inline">{module, opts}</code>, but will use one
of the provided functions that return that, like <code class="inline">always()</code> or
<code class="inline">actor_attribute_matches_record(:foo, :bar)</code>. To make custom ones
define a module that implements the <a href="AshPolicyAuthorizer.Check.html"><code class="inline">AshPolicyAuthorizer.Check</code></a> behaviour,
put a convenience function in that module that returns {module, opts}, and
import that into your resource.  </p><pre><code class="makeup elixir"><span class="kd">defmodule</span><span class="w"> </span><span class="nc">MyResource</span><span class="w"> </span><span class="k" data-group-id="3135030439-1">do</span><span class="w">
</span><span class="kn">use</span><span class="w"> </span><span class="nc">Ash.Resource</span><span class="p">,</span><span class="w"> </span><span class="ss">authorizers</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="3135030439-2">[</span><span class="nc">AshPolicyAuthorizer.Authorizer</span><span class="p" data-group-id="3135030439-2">]</span><span class="w">  
</span><span class="kn">import</span><span class="w"> </span><span class="nc">MyCustomCheck</span><span class="w">  
</span><span class="n">policies</span><span class="w"> </span><span class="k" data-group-id="3135030439-3">do</span><span class="w">
</span><span class="n">...</span><span class="w">
</span><span class="n">policy</span><span class="w"> </span><span class="k" data-group-id="3135030439-4">do</span><span class="w">
  </span><span class="n">authorize_if</span><span class="w"> </span><span class="n">my_custom_check</span><span class="p" data-group-id="3135030439-5">(</span><span class="ss">:foo</span><span class="p" data-group-id="3135030439-5">)</span><span class="w">
</span><span class="k" data-group-id="3135030439-4">end</span><span class="w">
</span><span class="k" data-group-id="3135030439-3">end</span><span class="w">
</span><span class="k" data-group-id="3135030439-1">end</span></code></pre></li><li><p><code class="inline">:name</code> - A short name or description for the check, used when explaining authorization results</p></li></ul><h5>forbid_if</h5><p>If the check is true, the request is forbidden, otherwise run remaining checks.</p><p>Introspection Target:</p><p><code class="inline">AshPolicyAuthorizer.Policy.Check</code></p><p>Examples:</p><pre><code class="makeup elixir"><span class="n">forbid_if</span><span class="w"> </span><span class="n">not_logged_in</span><span class="p" data-group-id="2955923407-1">(</span><span class="p" data-group-id="2955923407-1">)</span></code></pre><pre><code class="makeup elixir"><span class="n">forbid_if</span><span class="w"> </span><span class="n">actor_attribute_matches_record</span><span class="p" data-group-id="3478377860-1">(</span><span class="ss">:group</span><span class="p">,</span><span class="w"> </span><span class="ss">:blacklisted_groups</span><span class="p" data-group-id="3478377860-1">)</span></code></pre><ul><li><p><code class="inline">:check</code> - Required. A check is a tuple of <code class="inline">{module, keyword}</code>.<br/>The module must implement the <a href="AshPolicyAuthorizer.Check.html"><code class="inline">AshPolicyAuthorizer.Check</code></a> behaviour.
Generally, you won't be passing <code class="inline">{module, opts}</code>, but will use one
of the provided functions that return that, like <code class="inline">always()</code> or
<code class="inline">actor_attribute_matches_record(:foo, :bar)</code>. To make custom ones
define a module that implements the <a href="AshPolicyAuthorizer.Check.html"><code class="inline">AshPolicyAuthorizer.Check</code></a> behaviour,
put a convenience function in that module that returns {module, opts}, and
import that into your resource.  </p><pre><code class="makeup elixir"><span class="kd">defmodule</span><span class="w"> </span><span class="nc">MyResource</span><span class="w"> </span><span class="k" data-group-id="9840932520-1">do</span><span class="w">
</span><span class="kn">use</span><span class="w"> </span><span class="nc">Ash.Resource</span><span class="p">,</span><span class="w"> </span><span class="ss">authorizers</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="9840932520-2">[</span><span class="nc">AshPolicyAuthorizer.Authorizer</span><span class="p" data-group-id="9840932520-2">]</span><span class="w">  
</span><span class="kn">import</span><span class="w"> </span><span class="nc">MyCustomCheck</span><span class="w">  
</span><span class="n">policies</span><span class="w"> </span><span class="k" data-group-id="9840932520-3">do</span><span class="w">
</span><span class="n">...</span><span class="w">
</span><span class="n">policy</span><span class="w"> </span><span class="k" data-group-id="9840932520-4">do</span><span class="w">
  </span><span class="n">authorize_if</span><span class="w"> </span><span class="n">my_custom_check</span><span class="p" data-group-id="9840932520-5">(</span><span class="ss">:foo</span><span class="p" data-group-id="9840932520-5">)</span><span class="w">
</span><span class="k" data-group-id="9840932520-4">end</span><span class="w">
</span><span class="k" data-group-id="9840932520-3">end</span><span class="w">
</span><span class="k" data-group-id="9840932520-1">end</span></code></pre></li><li><p><code class="inline">:name</code> - A short name or description for the check, used when explaining authorization results</p></li></ul><h5>authorize_unless</h5><p>If the check is false, the request is authorized, otherwise run remaining checks.</p><p>Introspection Target:</p><p><code class="inline">AshPolicyAuthorizer.Policy.Check</code></p><p>Examples:</p><pre><code class="makeup elixir"><span class="n">authorize_unless</span><span class="w"> </span><span class="n">not_logged_in</span><span class="p" data-group-id="0677103319-1">(</span><span class="p" data-group-id="0677103319-1">)</span></code></pre><pre><code class="makeup elixir"><span class="n">authorize_unless</span><span class="w"> </span><span class="n">actor_attribute_matches_record</span><span class="p" data-group-id="1399258925-1">(</span><span class="ss">:group</span><span class="p">,</span><span class="w"> </span><span class="ss">:blacklisted_groups</span><span class="p" data-group-id="1399258925-1">)</span></code></pre><ul><li><p><code class="inline">:check</code> - Required. A check is a tuple of <code class="inline">{module, keyword}</code>.<br/>The module must implement the <a href="AshPolicyAuthorizer.Check.html"><code class="inline">AshPolicyAuthorizer.Check</code></a> behaviour.
Generally, you won't be passing <code class="inline">{module, opts}</code>, but will use one
of the provided functions that return that, like <code class="inline">always()</code> or
<code class="inline">actor_attribute_matches_record(:foo, :bar)</code>. To make custom ones
define a module that implements the <a href="AshPolicyAuthorizer.Check.html"><code class="inline">AshPolicyAuthorizer.Check</code></a> behaviour,
put a convenience function in that module that returns {module, opts}, and
import that into your resource.  </p><pre><code class="makeup elixir"><span class="kd">defmodule</span><span class="w"> </span><span class="nc">MyResource</span><span class="w"> </span><span class="k" data-group-id="9398661237-1">do</span><span class="w">
</span><span class="kn">use</span><span class="w"> </span><span class="nc">Ash.Resource</span><span class="p">,</span><span class="w"> </span><span class="ss">authorizers</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="9398661237-2">[</span><span class="nc">AshPolicyAuthorizer.Authorizer</span><span class="p" data-group-id="9398661237-2">]</span><span class="w">  
</span><span class="kn">import</span><span class="w"> </span><span class="nc">MyCustomCheck</span><span class="w">  
</span><span class="n">policies</span><span class="w"> </span><span class="k" data-group-id="9398661237-3">do</span><span class="w">
</span><span class="n">...</span><span class="w">
</span><span class="n">policy</span><span class="w"> </span><span class="k" data-group-id="9398661237-4">do</span><span class="w">
  </span><span class="n">authorize_if</span><span class="w"> </span><span class="n">my_custom_check</span><span class="p" data-group-id="9398661237-5">(</span><span class="ss">:foo</span><span class="p" data-group-id="9398661237-5">)</span><span class="w">
</span><span class="k" data-group-id="9398661237-4">end</span><span class="w">
</span><span class="k" data-group-id="9398661237-3">end</span><span class="w">
</span><span class="k" data-group-id="9398661237-1">end</span></code></pre></li><li><p><code class="inline">:name</code> - A short name or description for the check, used when explaining authorization results</p></li></ul><h5>forbid_unless</h5><p>If the check is true, the request is forbidden, otherwise run remaining checks.</p><p>Introspection Target:</p><p><code class="inline">AshPolicyAuthorizer.Policy.Check</code></p><p>Examples:</p><pre><code class="makeup elixir"><span class="n">forbid_unless</span><span class="w"> </span><span class="n">logged_in</span><span class="p" data-group-id="9339276813-1">(</span><span class="p" data-group-id="9339276813-1">)</span></code></pre><pre><code class="makeup elixir"><span class="n">forbid_unless</span><span class="w"> </span><span class="n">actor_attribute_matches_record</span><span class="p" data-group-id="4397314210-1">(</span><span class="ss">:group</span><span class="p">,</span><span class="w"> </span><span class="ss">:group</span><span class="p" data-group-id="4397314210-1">)</span></code></pre><ul><li><p><code class="inline">:check</code> - Required. A check is a tuple of <code class="inline">{module, keyword}</code>.<br/>The module must implement the <a href="AshPolicyAuthorizer.Check.html"><code class="inline">AshPolicyAuthorizer.Check</code></a> behaviour.
Generally, you won't be passing <code class="inline">{module, opts}</code>, but will use one
of the provided functions that return that, like <code class="inline">always()</code> or
<code class="inline">actor_attribute_matches_record(:foo, :bar)</code>. To make custom ones
define a module that implements the <a href="AshPolicyAuthorizer.Check.html"><code class="inline">AshPolicyAuthorizer.Check</code></a> behaviour,
put a convenience function in that module that returns {module, opts}, and
import that into your resource.  </p><pre><code class="makeup elixir"><span class="kd">defmodule</span><span class="w"> </span><span class="nc">MyResource</span><span class="w"> </span><span class="k" data-group-id="4827083577-1">do</span><span class="w">
</span><span class="kn">use</span><span class="w"> </span><span class="nc">Ash.Resource</span><span class="p">,</span><span class="w"> </span><span class="ss">authorizers</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="4827083577-2">[</span><span class="nc">AshPolicyAuthorizer.Authorizer</span><span class="p" data-group-id="4827083577-2">]</span><span class="w">  
</span><span class="kn">import</span><span class="w"> </span><span class="nc">MyCustomCheck</span><span class="w">  
</span><span class="n">policies</span><span class="w"> </span><span class="k" data-group-id="4827083577-3">do</span><span class="w">
</span><span class="n">...</span><span class="w">
</span><span class="n">policy</span><span class="w"> </span><span class="k" data-group-id="4827083577-4">do</span><span class="w">
  </span><span class="n">authorize_if</span><span class="w"> </span><span class="n">my_custom_check</span><span class="p" data-group-id="4827083577-5">(</span><span class="ss">:foo</span><span class="p" data-group-id="4827083577-5">)</span><span class="w">
</span><span class="k" data-group-id="4827083577-4">end</span><span class="w">
</span><span class="k" data-group-id="4827083577-3">end</span><span class="w">
</span><span class="k" data-group-id="4827083577-1">end</span></code></pre></li><li><p><code class="inline">:name</code> - A short name or description for the check, used when explaining authorization results</p></li></ul><h3 id="module-bypass" class="section-heading">
  <a href="#module-bypass" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  bypass
</h3>
<p>A policy that, if passed, will skip all following policies. If failed, authorization moves on to the next policy</p><ul><li><a href="#module-authorize_if">authorize_if</a></li><li><a href="#module-forbid_if">forbid_if</a></li><li><a href="#module-authorize_unless">authorize_unless</a></li><li><a href="#module-forbid_unless">forbid_unless</a></li></ul><p>Introspection Target:</p><p><code class="inline">AshPolicyAuthorizer.Policy</code></p><ul><li><p><code class="inline">:description</code> - A description for the policy, used when explaining authorization results</p></li><li><p><code class="inline">:access_type</code> - There are three choices for access_type:  </p></li><li><p><code class="inline">:strict</code> - authentication uses <em>only</em> the request context, failing when unknown.</p></li><li><p><code class="inline">:filter</code> - this is probably what you want. Automatically removes unauthorized data by altering the request filter.</p></li><li><p><code class="inline">:runtime</code> - tries to add a filter before the query, but if it cannot, it fetches the records and checks authorization.<br/>Be careful with runtime checks, as they can potentially cause a given scenario to fetch <em>all</em> records of a resource, because
it can't figure out a common filter between all of the possible scenarios. Use sparingly, if at all.</p><ul><li><code class="inline">:condition</code> - A check or list of checks that must be true in order for this policy to apply.  </li></ul></li></ul><p>If the policy does not apply, it is not run, and some other policy
will need to authorize the request. If no policies apply, the request
is forbidden. If multiple policies apply, they must each authorize the
request.</p><h5>authorize_if</h5><p>If the check is true, the request is authorized, otherwise run remaining checks.</p><p>Introspection Target:</p><p><code class="inline">AshPolicyAuthorizer.Policy.Check</code></p><p>Examples:</p><pre><code class="makeup elixir"><span class="n">authorize_if</span><span class="w"> </span><span class="n">logged_in</span><span class="p" data-group-id="8757989755-1">(</span><span class="p" data-group-id="8757989755-1">)</span></code></pre><pre><code class="makeup elixir"><span class="n">authorize_if</span><span class="w"> </span><span class="n">actor_attribute_matches_record</span><span class="p" data-group-id="6117112608-1">(</span><span class="ss">:group</span><span class="p">,</span><span class="w"> </span><span class="ss">:group</span><span class="p" data-group-id="6117112608-1">)</span></code></pre><ul><li><p><code class="inline">:check</code> - Required. A check is a tuple of <code class="inline">{module, keyword}</code>.<br/>The module must implement the <a href="AshPolicyAuthorizer.Check.html"><code class="inline">AshPolicyAuthorizer.Check</code></a> behaviour.
Generally, you won't be passing <code class="inline">{module, opts}</code>, but will use one
of the provided functions that return that, like <code class="inline">always()</code> or
<code class="inline">actor_attribute_matches_record(:foo, :bar)</code>. To make custom ones
define a module that implements the <a href="AshPolicyAuthorizer.Check.html"><code class="inline">AshPolicyAuthorizer.Check</code></a> behaviour,
put a convenience function in that module that returns {module, opts}, and
import that into your resource.  </p><pre><code class="makeup elixir"><span class="kd">defmodule</span><span class="w"> </span><span class="nc">MyResource</span><span class="w"> </span><span class="k" data-group-id="5790651010-1">do</span><span class="w">
</span><span class="kn">use</span><span class="w"> </span><span class="nc">Ash.Resource</span><span class="p">,</span><span class="w"> </span><span class="ss">authorizers</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="5790651010-2">[</span><span class="nc">AshPolicyAuthorizer.Authorizer</span><span class="p" data-group-id="5790651010-2">]</span><span class="w">  
</span><span class="kn">import</span><span class="w"> </span><span class="nc">MyCustomCheck</span><span class="w">  
</span><span class="n">policies</span><span class="w"> </span><span class="k" data-group-id="5790651010-3">do</span><span class="w">
</span><span class="n">...</span><span class="w">
</span><span class="n">policy</span><span class="w"> </span><span class="k" data-group-id="5790651010-4">do</span><span class="w">
  </span><span class="n">authorize_if</span><span class="w"> </span><span class="n">my_custom_check</span><span class="p" data-group-id="5790651010-5">(</span><span class="ss">:foo</span><span class="p" data-group-id="5790651010-5">)</span><span class="w">
</span><span class="k" data-group-id="5790651010-4">end</span><span class="w">
</span><span class="k" data-group-id="5790651010-3">end</span><span class="w">
</span><span class="k" data-group-id="5790651010-1">end</span></code></pre></li><li><p><code class="inline">:name</code> - A short name or description for the check, used when explaining authorization results</p></li></ul><h5>forbid_if</h5><p>If the check is true, the request is forbidden, otherwise run remaining checks.</p><p>Introspection Target:</p><p><code class="inline">AshPolicyAuthorizer.Policy.Check</code></p><p>Examples:</p><pre><code class="makeup elixir"><span class="n">forbid_if</span><span class="w"> </span><span class="n">not_logged_in</span><span class="p" data-group-id="6104812736-1">(</span><span class="p" data-group-id="6104812736-1">)</span></code></pre><pre><code class="makeup elixir"><span class="n">forbid_if</span><span class="w"> </span><span class="n">actor_attribute_matches_record</span><span class="p" data-group-id="1494530676-1">(</span><span class="ss">:group</span><span class="p">,</span><span class="w"> </span><span class="ss">:blacklisted_groups</span><span class="p" data-group-id="1494530676-1">)</span></code></pre><ul><li><p><code class="inline">:check</code> - Required. A check is a tuple of <code class="inline">{module, keyword}</code>.<br/>The module must implement the <a href="AshPolicyAuthorizer.Check.html"><code class="inline">AshPolicyAuthorizer.Check</code></a> behaviour.
Generally, you won't be passing <code class="inline">{module, opts}</code>, but will use one
of the provided functions that return that, like <code class="inline">always()</code> or
<code class="inline">actor_attribute_matches_record(:foo, :bar)</code>. To make custom ones
define a module that implements the <a href="AshPolicyAuthorizer.Check.html"><code class="inline">AshPolicyAuthorizer.Check</code></a> behaviour,
put a convenience function in that module that returns {module, opts}, and
import that into your resource.  </p><pre><code class="makeup elixir"><span class="kd">defmodule</span><span class="w"> </span><span class="nc">MyResource</span><span class="w"> </span><span class="k" data-group-id="1347507207-1">do</span><span class="w">
</span><span class="kn">use</span><span class="w"> </span><span class="nc">Ash.Resource</span><span class="p">,</span><span class="w"> </span><span class="ss">authorizers</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="1347507207-2">[</span><span class="nc">AshPolicyAuthorizer.Authorizer</span><span class="p" data-group-id="1347507207-2">]</span><span class="w">  
</span><span class="kn">import</span><span class="w"> </span><span class="nc">MyCustomCheck</span><span class="w">  
</span><span class="n">policies</span><span class="w"> </span><span class="k" data-group-id="1347507207-3">do</span><span class="w">
</span><span class="n">...</span><span class="w">
</span><span class="n">policy</span><span class="w"> </span><span class="k" data-group-id="1347507207-4">do</span><span class="w">
  </span><span class="n">authorize_if</span><span class="w"> </span><span class="n">my_custom_check</span><span class="p" data-group-id="1347507207-5">(</span><span class="ss">:foo</span><span class="p" data-group-id="1347507207-5">)</span><span class="w">
</span><span class="k" data-group-id="1347507207-4">end</span><span class="w">
</span><span class="k" data-group-id="1347507207-3">end</span><span class="w">
</span><span class="k" data-group-id="1347507207-1">end</span></code></pre></li><li><p><code class="inline">:name</code> - A short name or description for the check, used when explaining authorization results</p></li></ul><h5>authorize_unless</h5><p>If the check is false, the request is authorized, otherwise run remaining checks.</p><p>Introspection Target:</p><p><code class="inline">AshPolicyAuthorizer.Policy.Check</code></p><p>Examples:</p><pre><code class="makeup elixir"><span class="n">authorize_unless</span><span class="w"> </span><span class="n">not_logged_in</span><span class="p" data-group-id="0619640808-1">(</span><span class="p" data-group-id="0619640808-1">)</span></code></pre><pre><code class="makeup elixir"><span class="n">authorize_unless</span><span class="w"> </span><span class="n">actor_attribute_matches_record</span><span class="p" data-group-id="1806269114-1">(</span><span class="ss">:group</span><span class="p">,</span><span class="w"> </span><span class="ss">:blacklisted_groups</span><span class="p" data-group-id="1806269114-1">)</span></code></pre><ul><li><p><code class="inline">:check</code> - Required. A check is a tuple of <code class="inline">{module, keyword}</code>.<br/>The module must implement the <a href="AshPolicyAuthorizer.Check.html"><code class="inline">AshPolicyAuthorizer.Check</code></a> behaviour.
Generally, you won't be passing <code class="inline">{module, opts}</code>, but will use one
of the provided functions that return that, like <code class="inline">always()</code> or
<code class="inline">actor_attribute_matches_record(:foo, :bar)</code>. To make custom ones
define a module that implements the <a href="AshPolicyAuthorizer.Check.html"><code class="inline">AshPolicyAuthorizer.Check</code></a> behaviour,
put a convenience function in that module that returns {module, opts}, and
import that into your resource.  </p><pre><code class="makeup elixir"><span class="kd">defmodule</span><span class="w"> </span><span class="nc">MyResource</span><span class="w"> </span><span class="k" data-group-id="3063413556-1">do</span><span class="w">
</span><span class="kn">use</span><span class="w"> </span><span class="nc">Ash.Resource</span><span class="p">,</span><span class="w"> </span><span class="ss">authorizers</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="3063413556-2">[</span><span class="nc">AshPolicyAuthorizer.Authorizer</span><span class="p" data-group-id="3063413556-2">]</span><span class="w">  
</span><span class="kn">import</span><span class="w"> </span><span class="nc">MyCustomCheck</span><span class="w">  
</span><span class="n">policies</span><span class="w"> </span><span class="k" data-group-id="3063413556-3">do</span><span class="w">
</span><span class="n">...</span><span class="w">
</span><span class="n">policy</span><span class="w"> </span><span class="k" data-group-id="3063413556-4">do</span><span class="w">
  </span><span class="n">authorize_if</span><span class="w"> </span><span class="n">my_custom_check</span><span class="p" data-group-id="3063413556-5">(</span><span class="ss">:foo</span><span class="p" data-group-id="3063413556-5">)</span><span class="w">
</span><span class="k" data-group-id="3063413556-4">end</span><span class="w">
</span><span class="k" data-group-id="3063413556-3">end</span><span class="w">
</span><span class="k" data-group-id="3063413556-1">end</span></code></pre></li><li><p><code class="inline">:name</code> - A short name or description for the check, used when explaining authorization results</p></li></ul><h5>forbid_unless</h5><p>If the check is true, the request is forbidden, otherwise run remaining checks.</p><p>Introspection Target:</p><p><code class="inline">AshPolicyAuthorizer.Policy.Check</code></p><p>Examples:</p><pre><code class="makeup elixir"><span class="n">forbid_unless</span><span class="w"> </span><span class="n">logged_in</span><span class="p" data-group-id="8059547768-1">(</span><span class="p" data-group-id="8059547768-1">)</span></code></pre><pre><code class="makeup elixir"><span class="n">forbid_unless</span><span class="w"> </span><span class="n">actor_attribute_matches_record</span><span class="p" data-group-id="4425237598-1">(</span><span class="ss">:group</span><span class="p">,</span><span class="w"> </span><span class="ss">:group</span><span class="p" data-group-id="4425237598-1">)</span></code></pre><ul><li><p><code class="inline">:check</code> - Required. A check is a tuple of <code class="inline">{module, keyword}</code>.<br/>The module must implement the <a href="AshPolicyAuthorizer.Check.html"><code class="inline">AshPolicyAuthorizer.Check</code></a> behaviour.
Generally, you won't be passing <code class="inline">{module, opts}</code>, but will use one
of the provided functions that return that, like <code class="inline">always()</code> or
<code class="inline">actor_attribute_matches_record(:foo, :bar)</code>. To make custom ones
define a module that implements the <a href="AshPolicyAuthorizer.Check.html"><code class="inline">AshPolicyAuthorizer.Check</code></a> behaviour,
put a convenience function in that module that returns {module, opts}, and
import that into your resource.  </p><pre><code class="makeup elixir"><span class="kd">defmodule</span><span class="w"> </span><span class="nc">MyResource</span><span class="w"> </span><span class="k" data-group-id="5632288183-1">do</span><span class="w">
</span><span class="kn">use</span><span class="w"> </span><span class="nc">Ash.Resource</span><span class="p">,</span><span class="w"> </span><span class="ss">authorizers</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="5632288183-2">[</span><span class="nc">AshPolicyAuthorizer.Authorizer</span><span class="p" data-group-id="5632288183-2">]</span><span class="w">  
</span><span class="kn">import</span><span class="w"> </span><span class="nc">MyCustomCheck</span><span class="w">  
</span><span class="n">policies</span><span class="w"> </span><span class="k" data-group-id="5632288183-3">do</span><span class="w">
</span><span class="n">...</span><span class="w">
</span><span class="n">policy</span><span class="w"> </span><span class="k" data-group-id="5632288183-4">do</span><span class="w">
  </span><span class="n">authorize_if</span><span class="w"> </span><span class="n">my_custom_check</span><span class="p" data-group-id="5632288183-5">(</span><span class="ss">:foo</span><span class="p" data-group-id="5632288183-5">)</span><span class="w">
</span><span class="k" data-group-id="5632288183-4">end</span><span class="w">
</span><span class="k" data-group-id="5632288183-3">end</span><span class="w">
</span><span class="k" data-group-id="5632288183-1">end</span></code></pre></li><li><p><code class="inline">:name</code> - A short name or description for the check, used when explaining authorization results</p></li></ul><p>A resource can be given a set of policies, which are enforced on each call to a resource action.</p><p>For reads, policies can be configured to filter out data that the actor shouldn't see, as opposed to
resulting in a forbidden error.</p><p>See the <a href="writing_policies.html">policy writing guide</a> for practical examples.</p><p>Policies are solved/managed via a boolean satisfiability solver. To read more about boolean satisfiability,
see this page: <a href="https://en.wikipedia.org/wiki/Boolean_satisfiability_problem.">https://en.wikipedia.org/wiki/Boolean_satisfiability_problem.</a> At the end of
the day, however, it is not necessary to understand exactly how Ash takes your
authorization requirements and determines if a request is allowed. The
important thing to understand is that Ash may or may not run any/all of your
authorization rules as they may be deemed unnecessary. As such, authorization
checks should have no side effects. Ideally, the checks built-in to ash should
cover the bulk of your needs.</p>
        </section>


        <section id="summary" class="details-list">
          <h1 class="section-heading">
            <a class="hover-link" href="#summary">
              <span class="icon-link" aria-hidden="true"></span>
              <span class="sr-only">Link to this section</span>
            </a>
            Summary
          </h1>

  <div class="summary-types summary">
    <h2>
      <a href="#types">Types</a>
    </h2>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#t:t/0">t()</a>

  </div>

</div>

  </div>

        </section>


        <section id="types" class="details-list">
          <h1 class="section-heading">
            <a class="hover-link" href="#types">
              <span class="icon-link" aria-hidden="true"></span>
              <span class="sr-only">Link to this section</span>
            </a>
Types
          </h1>
          <div class="types-list">
<section class="detail" id="t:t/0">

  <div class="detail-header">
    <a href="#t:t/0" class="detail-link" title="Link to this type">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature">t()</h1>

      <a href="https://github.com/ash-project/ash_policy_authorizer/blob/v0.16.5/lib/ash_policy_authorizer/authorizer.ex#L19" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>t() :: %AshPolicyAuthorizer.Authorizer{
  action: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>(),
  actor: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>(),
  api: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>(),
  changeset: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>(),
  check_scenarios: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>(),
  data: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>(),
  data_facts: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>(),
  facts: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>(),
  policies: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>(),
  query: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>(),
  real_scenarios: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>(),
  resource: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>(),
  scenarios: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>(),
  verbose?: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>()
}</pre>

      </div>


  </section>
</section>

          </div>
        </section>

      <footer class="footer">

        <p>
          Find it on Hex:
          <a href="https://hex.pm/packages/ash_policy_authorizer/0.16.5" class="line footer-hex-package">Package</a>
          <a href="https://preview.hex.pm/preview/ash_policy_authorizer/0.16.5" class="line">Preview</a>

            <a href="https://preview.hex.pm/preview/ash_policy_authorizer/0.16.5/show/lib/ash_policy_authorizer/authorizer.ex">(current file)</a>

        </p>

        <p>
          <span class="line">
            Built using
            <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener">ExDoc</a> (v0.25.2) for the
            <a href="https://elixir-lang.org" title="Elixir" target="_blank">Elixir programming language</a>.
          </span>
          <span class="line">
            Designed by
            <a href="https://twitter.com/dignifiedquire" target="_blank" rel="noopener" title="@dignifiedquire">Friedel Ziegelmayer</a>.
          </span>
        </p>
        <p>

            <a href="api-reference.html" title="API reference" class="line footer-button">API Reference</a>

          <button class="line footer-button display-shortcuts-help">
            Display keyboard shortcuts
          </button>
          <button class="line footer-button night-mode-toggle">
            Toggle night mode
          </button>
          <button class="line footer-button display-quick-switch">
            Go to a HexDocs package
          </button>
          <button class="line footer-button tooltips-toggle">
            <span class="tooltips-option-disable">Disable tooltips</span>
            <span class="tooltips-option-enable">Enable tooltips</span>
          </button>
        </p>
      </footer>
    </div>
  </div>
</section>
</div>


  </body>
</html>
